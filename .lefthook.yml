# Lefthook Configuration
# Uses TypeScript validators instead of shell scripts (SOLID, DRY, Zod)

pre-commit:
  parallel: false
  commands:
    validate-gitlab-ci:
      run: tsx src/tools/validation/gitlab-ci-validator.ts .gitlab-ci.yml
      glob: ".gitlab-ci.yml"
      stage_fixed: true

    prevent-hardcoded-versions:
      run: tsx src/tools/validation/version-validator.ts
      stage_fixed: false

pre-push:
  parallel: true
  commands:
    # Validation engine - architectural rules enforcement
    validation-engine:
      run: npx @bluefly/validation-engine validate --hook=pre-push
      fail_text: |
        ‚ùå VALIDATION FAILED - Push blocked
        Fix violations above or request exception:
          npm run validation exception request

    # Run tests
    test:
      run: npm test
      skip:
        - merge
        - rebase
