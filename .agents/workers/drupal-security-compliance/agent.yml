ossaVersion: "1.0"
agent:
  id: drupal-security-compliance
  name: Drupal Security Compliance
  version: 0.1.9
  description: Drupal security and compliance specialist for FedRAMP, NIST, and
    enterprise security requirements
  role: custom
  tags:
    - worker
    - drupal-security
    - compliance
    - drupal-platform
  runtime:
    type: docker
    resources:
      cpu: 2
      memory: 4Gi
  capabilities:
    - name: security_audit
      description: Comprehensive security audit of Drupal site following NIST and
        FedRAMP guidelines
      input_schema:
        type: object
        required:
          - siteInfo
        properties:
          siteInfo:
            type: object
            properties:
              drupalRoot:
                type: string
              siteUrl:
                type: string
              environment:
                type: string
                enum:
                  - development
                  - staging
                  - production
              hostingProvider:
                type: string
              drupalVersion:
                type: string
          auditScope:
            type: object
            properties:
              codeAudit:
                type: boolean
                default: true
              configAudit:
                type: boolean
                default: true
              moduleAudit:
                type: boolean
                default: true
              permissionsAudit:
                type: boolean
                default: true
              accessibilityCheck:
                type: boolean
                default: true
              performanceCheck:
                type: boolean
                default: true
          complianceFrameworks:
            type: array
            items:
              type: string
              enum:
                - fedramp
                - nist_csf
                - nist_800_53
                - sox
                - hipaa
                - gdpr
                - wcag_aa
      output_schema:
        type: object
        properties:
          auditId:
            type: string
          overallScore:
            type: number
            minimum: 0
            maximum: 100
          riskLevel:
            type: string
            enum:
              - low
              - medium
              - high
              - critical
          findings:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                category:
                  type: string
                  enum:
                    - authentication
                    - authorization
                    - data_protection
                    - input_validation
                    - session_management
                    - logging
                    - configuration
                    - dependencies
                severity:
                  type: string
                  enum:
                    - info
                    - low
                    - medium
                    - high
                    - critical
                title:
                  type: string
                description:
                  type: string
                impact:
                  type: string
                remediation:
                  type: string
                compliance_mappings:
                  type: array
                cwe_id:
                  type: string
                cvss_score:
                  type: number
          complianceReport:
            type: object
            properties:
              fedramp:
                type: object
                properties:
                  status:
                    type: string
                  controls_met:
                    type: number
                  controls_total:
                    type: number
                  gaps:
                    type: array
              nist:
                type: object
                properties:
                  framework_alignment:
                    type: string
                  category_scores:
                    type: object
                  recommendations:
                    type: array
              accessibility:
                type: object
                properties:
                  wcag_level:
                    type: string
                  violations:
                    type: array
                  success_criteria:
                    type: object
          remediationPlan:
            type: array
            items:
              type: object
              properties:
                priority:
                  type: string
                effort:
                  type: string
                timeline:
                  type: string
                resources:
                  type: array
      timeout_seconds: 1800000
    - name: vulnerability_scan
      description: Automated vulnerability scanning for Drupal core, modules, and
        custom code
      input_schema:
        type: object
        required:
          - target
        properties:
          target:
            type: object
            properties:
              type:
                type: string
                enum:
                  - site
                  - code
                  - modules
                  - dependencies
              path:
                type: string
              url:
                type: string
          scanOptions:
            type: object
            properties:
              scanDepth:
                type: string
                enum:
                  - basic
                  - standard
                  - comprehensive
                default: standard
              includeContrib:
                type: boolean
                default: true
              includeCustom:
                type: boolean
                default: true
              activeScan:
                type: boolean
                default: false
              reportFormat:
                type: string
                enum:
                  - json
                  - html
                  - pdf
                  - sarif
                default: json
      output_schema:
        type: object
        properties:
          scanId:
            type: string
          scanDate:
            type: string
          vulnerabilities:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                cve_id:
                  type: string
                severity:
                  type: string
                  enum:
                    - info
                    - low
                    - medium
                    - high
                    - critical
                score:
                  type: number
                title:
                  type: string
                description:
                  type: string
                affected_component:
                  type: string
                fixed_version:
                  type: string
                patch_available:
                  type: boolean
                exploit_available:
                  type: boolean
                remediation:
                  type: string
          summary:
            type: object
            properties:
              total:
                type: number
              critical:
                type: number
              high:
                type: number
              medium:
                type: number
              low:
                type: number
              info:
                type: number
          recommendations:
            type: array
            items:
              type: object
              properties:
                action:
                  type: string
                priority:
                  type: string
                impact:
                  type: string
      timeout_seconds: 3600000
    - name: compliance_assessment
      description: Detailed compliance assessment against specific frameworks
      input_schema:
        type: object
        required:
          - framework
          - siteInfo
        properties:
          framework:
            type: string
            enum:
              - fedramp_low
              - fedramp_moderate
              - fedramp_high
              - nist_csf
              - nist_800_53
              - sox
              - hipaa
              - gdpr
          siteInfo:
            type: object
            properties:
              drupalRoot:
                type: string
              configPath:
                type: string
              environment:
                type: string
              dataClassification:
                type: string
          assessmentOptions:
            type: object
            properties:
              includeDocumentation:
                type: boolean
                default: true
              generateEvidence:
                type: boolean
                default: true
              createPOAM:
                type: boolean
                default: true
      output_schema:
        type: object
        properties:
          assessmentId:
            type: string
          framework:
            type: string
          complianceStatus:
            type: string
            enum:
              - compliant
              - partially_compliant
              - non_compliant
          overallScore:
            type: number
          controlsAssessment:
            type: array
            items:
              type: object
              properties:
                control_id:
                  type: string
                control_name:
                  type: string
                status:
                  type: string
                  enum:
                    - implemented
                    - partially_implemented
                    - planned
                    - not_implemented
                evidence:
                  type: array
                gaps:
                  type: array
                recommendations:
                  type: array
          documentation:
            type: object
            properties:
              ssp:
                type: string
              poam:
                type: string
              contingencyPlan:
                type: string
              incidentResponse:
                type: string
          nextSteps:
            type: array
      timeout_seconds: 7200000
    - name: generate_security_hardening
      description: Generate security hardening configuration for Drupal
      input_schema:
        type: object
        required:
          - environment
          - securityLevel
        properties:
          environment:
            type: string
            enum:
              - development
              - staging
              - production
          securityLevel:
            type: string
            enum:
              - basic
              - enhanced
              - maximum
          requirements:
            type: object
            properties:
              fedramp:
                type: boolean
                default: false
              hipaa:
                type: boolean
                default: false
              gdpr:
                type: boolean
                default: false
              pci:
                type: boolean
                default: false
          customizations:
            type: object
            properties:
              allowedModules:
                type: array
              deniedModules:
                type: array
              customPolicies:
                type: array
      output_schema:
        type: object
        properties:
          hardeningId:
            type: string
          configurations:
            type: object
            properties:
              drupalSettings:
                type: object
              phpSettings:
                type: object
              webserverConfig:
                type: object
              databaseConfig:
                type: object
              moduleConfigs:
                type: object
          securityModules:
            type: array
            items:
              type: object
              properties:
                name:
                  type: string
                version:
                  type: string
                configuration:
                  type: object
                required:
                  type: boolean
          policies:
            type: array
            items:
              type: object
              properties:
                category:
                  type: string
                policy:
                  type: string
                enforcement:
                  type: string
          monitoring:
            type: object
            properties:
              logSettings:
                type: object
              alertRules:
                type: array
              dashboards:
                type: array
      timeout_seconds: 900000
  policies:
    audit: true
  integration:
    protocol: http
    endpoints:
      base_url: http://localhost:3000
      health: /health
      metrics: /metrics
    auth:
      type: api-key
  monitoring:
    traces: true
    metrics: true
    logs: true
  metadata:
    author: Bluefly Drupal Platform Team
    license: Apache-2.0
    repository: https://gitlab.bluefly.io/llm/drupal-agents
