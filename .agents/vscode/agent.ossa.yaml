apiVersion: ossa/v0.3.0
kind: Agent

metadata:
  name: vscode-agent
  version: 1.0.0
  description: |
    OSSA-compliant agent for Visual Studio Code with Copilot and extensions.
    Provides code completion, chat, and workspace integration.

  labels:
    ossa-version: v0.3.0
    platform: vscode
    provider: microsoft
    category: ide

spec:
  taxonomy:
    domain: development
    subdomain: code-editing
    capability: ai-assistance

  role: |
    You are an AI coding assistant integrated with VS Code.

    Your responsibilities:
    1. Provide inline code completions
    2. Answer coding questions in chat
    3. Generate code from comments
    4. Suggest fixes for errors
    5. Assist with debugging

    Follow VS Code extension best practices.

  llm:
    provider: ${LLM_PROVIDER:-openai}
    model: ${LLM_MODEL:-gpt-4o}
    temperature: 0.2
    maxTokens: 4000

    fallback_models:
      - provider: ${LLM_FALLBACK_PROVIDER_1:-anthropic}
        model: ${LLM_FALLBACK_MODEL_1:-claude-sonnet-4}

    retry_config:
      max_attempts: 3
      backoff_strategy: exponential

    cost_tracking:
      enabled: true
      budget_alert_threshold: 50.00
      cost_allocation_tags:
        platform: vscode
        team: ide-agents

  capabilities:
    - name: inline_completion
      description: Generate inline code completions
      input_schema:
        type: object
        required: [document, position]
        properties:
          document:
            type: object
            properties:
              uri:
                type: string
              languageId:
                type: string
              text:
                type: string
          position:
            type: object
            properties:
              line:
                type: integer
              character:
                type: integer
      output_schema:
        type: object
        properties:
          completions:
            type: array
            items:
              type: object
              properties:
                text:
                  type: string
                range:
                  type: object

    - name: chat_assistance
      description: Provide chat-based coding help
      input_schema:
        type: object
        required: [message]
        properties:
          message:
            type: string
          workspace:
            type: object
          selection:
            type: object
      output_schema:
        type: object
        properties:
          response:
            type: string
          code_blocks:
            type: array
            items:
              type: object
          references:
            type: array
            items:
              type: string

    - name: workspace_edit
      description: Suggest workspace-wide edits
      input_schema:
        type: object
        required: [intent]
        properties:
          intent:
            type: string
          scope:
            type: string
            enum: [file, folder, workspace]
          files:
            type: array
            items:
              type: string
      output_schema:
        type: object
        properties:
          edits:
            type: array
            items:
              type: object
              properties:
                file:
                  type: string
                changes:
                  type: array
          summary:
            type: string

    - name: diagnostic_fix
      description: Suggest fixes for diagnostics
      input_schema:
        type: object
        required: [diagnostic]
        properties:
          diagnostic:
            type: object
            properties:
              message:
                type: string
              severity:
                type: string
              range:
                type: object
          document:
            type: object
      output_schema:
        type: object
        properties:
          fixes:
            type: array
            items:
              type: object
              properties:
                title:
                  type: string
                edit:
                  type: object

  runtime:
    type: local
    config:
      timeout: 30
      retries: 2

  integration:
    platform: vscode
    version: ">=1.85.0"
    configuration:
      extensions:
        - github.copilot
        - github.copilot-chat
      settings:
        editor.inlineSuggest.enabled: true
        github.copilot.enable: true
