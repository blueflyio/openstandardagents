# OpenAPI AI Agents Standard (OAAS) v0.1.8 - Drupal Architecture Fixer Agent
# Full Governed Tier compliance for architectural remediation and optimization

apiVersion: openapi-ai-agents/v0.1.8
kind: Agent
metadata:
  name: drupal-architecture-fixer
  version: 2.0.0
  description: |
    Expert Drupal architecture remediation agent specializing in structural fixes,
    performance optimization, scalability improvements, and enterprise-grade
    architectural transformations for complex Drupal systems.
  created: '2025-09-02T12:00:00.000Z'
  
  # Enhanced metadata for v0.1.8 Governed Tier
  labels:
    tier: governed
    domain: architecture-remediation
    category: architecture-specialist
    complexity: enterprise
    maturity: production-ready
    certification: governed-tier
    deployment: critical-systems
    
  annotations:
    ossa.io/conformance-level: "governed"
    ossa.io/migration-date: "2025-09-02"
    ossa.io/source-format: "ossa-v0.1.8"
    ossa.io/grade-target: "A+"
    ossa.io/compliance-level: "governed"
    ossa.io/certification: "drupal-architecture-fixer"
    
    # Framework integration annotations
    drupal/architecture-scope: "full-stack,database,caching,performance"
    drupal/remediation-types: "structural,performance,security,scalability"
    drupal/enterprise-patterns: "multi-site,high-availability,disaster-recovery"
    drupal/optimization-focus: "database,caching,cdn,clustering"
    
    langchain/tool-type: "remediation"
    langchain/async-support: "true"
    langchain/streaming: "supported"
    langchain/memory-compatible: "true"
    
    crewai/role-type: "architecture-lead"
    crewai/collaboration-mode: "strategic-oversight"
    crewai/delegation-enabled: "true"
    
    mcp/server-type: "architecture-tools"
    mcp/capabilities: "analysis,remediation,optimization,monitoring"

spec:
  # Agent identity and expertise
  agent:
    name: Drupal Architecture Remediation Specialist
    expertise: |
      Senior Drupal architect with expertise in:
      - Large-scale Drupal architecture analysis and remediation
      - Performance bottleneck identification and resolution
      - Database optimization and query performance tuning
      - Caching strategy implementation and optimization
      - Multi-site architecture and scaling solutions
      - High-availability and disaster recovery implementation
      - Enterprise security architecture hardening
      
  # Comprehensive architecture remediation capabilities
  capabilities:
    - name: architecture_analysis_remediation
      description: Analyze and fix structural architectural issues in Drupal systems
      input_schema:
        type: object
        properties:
          analysis_scope: { type: string, enum: ["full_system", "database", "caching", "performance", "security", "scalability"] }
          system_scale: { type: string, enum: ["small", "medium", "large", "enterprise"], default: "medium" }
          performance_targets: { type: object, description: "Target performance metrics" }
          constraints: { type: array, items: { type: string }, description: "System constraints and limitations" }
          priority_areas: { type: array, items: { type: string }, description: "High-priority remediation areas" }
        required: ["analysis_scope"]
      output_schema:
        type: object
        properties:
          architecture_assessment: { type: object, description: "Comprehensive system analysis" }
          remediation_plan: { type: object, description: "Detailed fix implementation plan" }
          code_changes: { type: object, description: "Required code modifications" }
          infrastructure_changes: { type: object, description: "Infrastructure updates needed" }
          migration_strategy: { type: string, description: "Safe implementation approach" }
          performance_projections: { type: object, description: "Expected improvements" }
        required: ["architecture_assessment", "remediation_plan"]
      frameworks: ["mcp", "langchain", "drupal"]
      sla: "99.9%"
      performance_targets:
        response_time: "< 30s for complex analysis"
        accuracy: "> 97%"
        
    - name: database_optimization
      description: Optimize database structure, queries, and performance for Drupal
      input_schema:
        type: object
        properties:
          optimization_type: { type: string, enum: ["structure", "queries", "indexes", "partitioning", "comprehensive"] }
          database_size: { type: string, enum: ["small", "medium", "large", "enterprise"] }
          performance_issues: { type: array, items: { type: string }, description: "Identified performance problems" }
          high_traffic_areas: { type: array, items: { type: string }, description: "High-load system components" }
          maintenance_window: { type: string, description: "Available maintenance time" }
        required: ["optimization_type"]
      output_schema:
        type: object
        properties:
          optimization_plan: { type: object, description: "Database optimization strategy" }
          query_improvements: { type: array, items: { type: object } }
          index_recommendations: { type: array, items: { type: object } }
          schema_modifications: { type: object, description: "Database schema changes" }
          migration_scripts: { type: array, items: { type: string } }
          performance_monitoring: { type: object, description: "Ongoing monitoring setup" }
        required: ["optimization_plan", "query_improvements"]
      frameworks: ["database", "mcp", "performance"]
      sla: "99.8%"
      
    - name: scalability_architecture
      description: Implement enterprise-scale architecture patterns for high availability
      input_schema:
        type: object
        properties:
          scaling_requirements: { type: object, description: "Traffic and load requirements" }
          architecture_pattern: { type: string, enum: ["horizontal", "vertical", "hybrid", "cloud_native"] }
          availability_targets: { type: string, enum: ["99.9", "99.95", "99.99", "99.999"] }
          disaster_recovery: { type: boolean, default: true }
          geographic_distribution: { type: boolean, default: false }
          auto_scaling: { type: boolean, default: true }
        required: ["scaling_requirements", "architecture_pattern"]
      output_schema:
        type: object
        properties:
          scalability_architecture: { type: object, description: "Complete scaling architecture" }
          load_balancing_config: { type: object, description: "Load balancer setup" }
          caching_strategy: { type: object, description: "Multi-tier caching implementation" }
          database_clustering: { type: object, description: "Database scaling solution" }
          monitoring_setup: { type: object, description: "Comprehensive monitoring configuration" }
          disaster_recovery_plan: { type: string, description: "DR implementation strategy" }
        required: ["scalability_architecture", "load_balancing_config"]
      frameworks: ["scalability", "cloud", "mcp"]
      sla: "99.7%"
      
    - name: security_architecture_hardening
      description: Implement enterprise-grade security architecture improvements
      input_schema:
        type: object
        properties:
          security_level: { type: string, enum: ["standard", "high", "critical", "government"], default: "high" }
          compliance_requirements: { type: array, items: { type: string } }
          threat_model: { type: object, description: "Security threat analysis" }
          existing_security: { type: object, description: "Current security measures" }
          integration_requirements: { type: array, items: { type: string } }
        required: ["security_level"]
      output_schema:
        type: object
        properties:
          security_architecture: { type: object, description: "Enhanced security design" }
          hardening_checklist: { type: array, items: { type: object } }
          access_control_implementation: { type: object, description: "RBAC and authentication setup" }
          security_monitoring: { type: object, description: "Security monitoring and alerting" }
          compliance_validation: { type: object, description: "Compliance framework adherence" }
          incident_response_plan: { type: string, description: "Security incident procedures" }
        required: ["security_architecture", "hardening_checklist"]
      frameworks: ["security", "compliance", "mcp"]
      sla: "99.9%"

  # Advanced context management for architecture work
  context_management:
    max_tokens: 512000
    optimization:
      strategy: architecture_focused
      compression: true
      summarization: true
      deduplication: true
      system_pattern_recognition: true
    memory:
      type: persistent
      capacity: 100000
      storage: vector_db
      retention: "365d"
      architecture_knowledge_base: true
    
  # Multi-framework configuration for architecture work
  frameworks:
    mcp:
      enabled: true
      version: "2024-11-05"
      server_name: drupal-architecture-fixer
      server_config:
        host: "0.0.0.0"
        port: 3214
        tools:
          - architecture_analyzer
          - performance_profiler
          - database_optimizer
          - security_scanner
          - scalability_planner
          - monitoring_configurator
        
    langchain:
      enabled: true
      version: "0.1.0"
      tool_type: architecture_specialized
      async_support: true
      streaming: true
      memory_compatible: true
      chain_compatible: true
      custom_chains:
        - architecture_analysis_chain
        - remediation_planning_chain
        - performance_optimization_chain
        
    crewai:
      enabled: true
      version: "0.1.0"
      role: architecture_lead
      backstory: |
        Senior enterprise architect with 20+ years of experience in large-scale
        system design, performance optimization, and architectural remediation.
        Specialized in mission-critical Drupal deployments and scalability.
      delegation: true
      collaboration: strategic_oversight
      skills:
        - system_architecture
        - performance_engineering
        - scalability_design
        - security_architecture
        - disaster_recovery
      
    enterprise_tools:
      enabled: true
      monitoring: true
      alerting: true
      automation: true
      deployment: true
      
    drupal:
      enabled: true
      version: "10.x,11.x"
      enterprise_modules:
        - memcache
        - redis
        - varnish_purge
        - cdn
        - stage_file_proxy
        - environment_indicator
      architecture_patterns:
        - multi_site
        - headless
        - microservices
        - high_availability
        
    llm_platform:
      enabled: true
      gateway_routing: true
      model_selection: "architecture_optimized"
      token_optimization: "system_analysis_focused"
      caching_strategy: "architecture_pattern_based"

  # UADP Discovery configuration for architecture services
  discovery:
    uadp:
      enabled: true
      endpoints:
        - url: "https://api.drupal-llm-platform.com/v1/discovery"
          method: GET
          headers:
            X-Agent-Type: "drupal-architecture-fixer"
            X-Capabilities: "architecture-analysis,performance-optimization,scalability,security-hardening"
        - url: "https://architecture.drupal.org/api/agents"
          method: POST
          payload:
            agent_type: "architecture-fixer"
            specialization: "enterprise-drupal-architecture"
      tags: ["drupal", "architecture", "performance", "scalability", "enterprise", "remediation"]
      priority: 95
      drupal_specific:
        architecture_scope: "enterprise-scale"
        optimization_focus: ["performance", "scalability", "security"]
        deployment_patterns: ["multi-site", "high-availability", "cloud-native"]
        
  # Enterprise integration for architecture operations
  integration:
    enterprise_systems:
      monitoring: "datadog,newrelic,grafana"
      logging: "elasticsearch,splunk"
      alerting: "pagerduty,opsgenie"
      deployment: "kubernetes,docker"
      
    authentication:
      type: jwt
      config:
        issuer: https://auth.drupal-platform.com
        audience: drupal-architecture-fixer
        algorithms: ["RS256", "ES256"]
        enterprise_sso: true
    
    rate_limiting:
      enabled: true
      requests_per_minute: 50
      burst: 25
      by_user: true
      architecture_analysis_queuing: true
      
    timeout:
      request: 1800000  # 30 minutes for complex architecture analysis
      connection: 120000
      remediation_operations: 7200000  # 2 hours for major fixes

  # Comprehensive monitoring for architecture operations
  monitoring:
    metrics:
      enabled: true
      export: prometheus
      endpoint: /metrics
      interval: 60
      custom_metrics:
        - architectures_analyzed
        - remediations_completed
        - performance_improvements
        - scalability_implementations
        - security_hardenings
        - system_uptime_improvements
        
    architecture_monitoring:
      system_health: true
      performance_metrics: true
      scalability_indicators: true
      security_posture: true
      
    logging:
      level: info
      format: json
      destinations:
        - stdout
        - architecture_logs
        - elasticsearch
        - enterprise_siem
      sampling_rate: 1.0
      architecture_audit_trail: true
      
    alerting:
      enabled: true
      channels: ["email", "slack", "pagerduty", "architecture_dashboard"]
      thresholds:
        analysis_failure_rate: 0.01
        remediation_success_rate: 0.95
        performance_regression: 0.05
        security_issues: 1

  # Enhanced security for architecture operations
  security:
    authentication:
      methods: ["jwt", "enterprise_sso", "certificate"]
      required: true
      privileged_access_management: true
      
    authorization:
      model: rbac
      roles: ["architect", "senior_architect", "principal_architect", "admin"]
      permissions:
        architect: ["read", "analyze_architecture", "basic_remediation"]
        senior_architect: ["read", "comprehensive_analysis", "performance_optimization", "security_hardening"]
        principal_architect: ["read", "enterprise_architecture", "strategic_planning", "disaster_recovery"]
        admin: ["all_permissions"]
        
    architecture_security:
      privileged_operations: true
      change_approval_required: true
      rollback_capabilities: true
      security_validation: mandatory
      
    secrets_management:
      provider: vault
      path: /secret/drupal-architecture-fixer
      auto_rotation: true
      enterprise_key_management: true

  # Compliance framework for architecture operations
  compliance:
    frameworks:
      - enterprise_architecture_framework
      - togaf_9_2
      - zachman_framework
      - iso_27001
      - nist_cybersecurity_framework
      - sox_compliance
      
    certification_level: governed
    audit_trail: true
    change_management: required
    
    architecture_governance:
      design_review_required: true
      performance_validation: mandatory
      security_assessment: required
      scalability_testing: implemented
      
    data_handling:
      encryption: both
      retention: "7years"
      architecture_documentation: mandatory
      disaster_recovery_tested: quarterly
      
    reporting:
      enabled: true
      frequency: monthly
      formats: ["json", "pdf", "enterprise_dashboard"]
      recipients: ["architecture-team@company.com", "cto@company.com"]

  # API specification for architecture operations
  api:
    specification: ./openapi-drupal-architecture-fixer.yaml
    base_url: https://api.drupal-platform.com/v1/architecture
    version: 1.0.0
    endpoints:
      - path: /analyze
        method: POST
        description: Analyze system architecture for issues
      - path: /remediate
        method: POST
        description: Execute architectural remediation plan
      - path: /optimize/database
        method: POST
        description: Optimize database architecture
      - path: /scale/architect
        method: POST
        description: Design scalability architecture
      - path: /secure/harden
        method: POST
        description: Implement security hardening
    
  # Performance optimization for architecture operations
  performance:
    token_optimization:
      enabled: true
      target_savings: "50-60%"
      strategies:
        - architecture_pattern_caching
        - analysis_result_reuse
        - incremental_remediation
        - parallel_optimization
        - knowledge_base_utilization
        
    caching:
      enabled: true
      ttl: 28800  # 8 hours
      levels: ["request", "computation", "result", "context", "architecture_cache"]
      storage: redis
      pattern_based_caching: true
      
    scaling:
      auto_scale: true
      min_replicas: 1
      max_replicas: 3
      target_cpu: 80
      target_memory: 85
      architecture_workload_aware: true

status:
  phase: ready
  conditions:
    - type: ready
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
    - type: healthy
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
    - type: compliant
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
    - type: architecture_certified
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
      
  deployment:
    replicas: 1
    available_replicas: 1
    ready_replicas: 1
    
  last_updated: "2025-09-02T12:00:00Z"
  architecture_patterns_supported: 25
  enterprise_certifications: ["TOGAF", "Zachman", "ISO27001"]