# OpenAPI AI Agents Standard (OAAS) v0.1.8 - Drupal Expert Agent
# Full Governed Tier compliance with enhanced capabilities and security

apiVersion: openapi-ai-agents/v0.1.8
kind: Agent
metadata:
  name: drupal-expert
  version: 2.0.0
  description: |
    Expert Drupal development agent specializing in module creation, best practices,
    API integrations, and enterprise-grade Drupal solutions. Provides comprehensive
    development guidance with performance optimization and security-first approach.
  created: '2025-09-02T12:00:00.000Z'
  
  # Enhanced metadata for v0.1.8 Governed Tier
  labels:
    tier: governed
    domain: drupal-development
    category: development-specialist
    complexity: enterprise
    maturity: production-ready
    certification: governed-tier
    deployment: multi-cloud
    
  annotations:
    ossa.io/conformance-level: "governed"
    ossa.io/migration-date: "2025-09-02"
    ossa.io/source-format: "ossa-v0.1.8"
    ossa.io/grade-target: "A+"
    ossa.io/compliance-level: "governed"
    ossa.io/certification: "drupal-expert"
    
    # Framework integration annotations
    drupal/version: "10.x,11.x"
    drupal/modules: "core,contrib,custom"
    drupal/apis: "entity,plugin,hook,queue,cache,service"
    drupal/composer: "enabled"
    
    langchain/tool-type: "structured"
    langchain/async-support: "true"
    langchain/streaming: "supported"
    langchain/memory-compatible: "true"
    
    crewai/role-type: "drupal-specialist"
    crewai/collaboration-mode: "team-lead"
    crewai/delegation-enabled: "true"
    
    mcp/server-type: "drupal-tools"
    mcp/capabilities: "module-creation,api-integration,performance"
    
    llm-platform/integration: "gateway-routed"
    llm-platform/optimization: "token-efficient"

spec:
  # Agent identity and expertise
  agent:
    name: Drupal Development Expert
    expertise: |
      Senior Drupal architect and developer with expertise in:
      - Drupal 10/11 module development and architecture
      - Custom plugin creation and API integrations
      - Entity API, Hook system, and Service containers
      - Performance optimization and caching strategies
      - Security best practices and compliance
      - Multi-site and headless Drupal implementations
      - Composer-based workflows and deployment automation
      
  # Comprehensive Drupal-specific capabilities
  capabilities:
    - name: drupal_module_development
      description: Create, enhance, and debug Drupal modules with best practices
      input_schema:
        type: object
        properties:
          module_type: { type: string, enum: ["custom", "contrib_patch", "theme", "distribution"] }
          requirements: { type: string, description: "Module requirements and functionality" }
          drupal_version: { type: string, enum: ["10.x", "11.x", "both"], default: "both" }
          dependencies: { type: array, items: { type: string }, description: "Required modules" }
          hooks_needed: { type: array, items: { type: string }, description: "Drupal hooks to implement" }
          plugins_needed: { type: array, items: { type: string }, description: "Plugin types needed" }
        required: ["module_type", "requirements"]
      output_schema:
        type: object
        properties:
          module_structure: { type: object, description: "Complete module file structure" }
          source_code: { type: object, description: "Generated PHP, YAML, and other files" }
          installation_notes: { type: string, description: "Installation and configuration steps" }
          dependencies_resolved: { type: array, items: { type: string } }
          performance_score: { type: number, minimum: 0, maximum: 1 }
      frameworks: ["mcp", "langchain", "drupal"]
      sla: "99.9%"
      performance_targets:
        response_time: "< 2s"
        token_efficiency: "4x optimization"
        
    - name: drupal_api_integration
      description: Integrate external APIs and services with Drupal architecture
      input_schema:
        type: object
        properties:
          api_type: { type: string, enum: ["rest", "graphql", "soap", "custom"] }
          integration_pattern: { type: string, enum: ["service", "plugin", "webhook", "queue"] }
          authentication: { type: string, enum: ["none", "basic", "oauth2", "jwt", "api_key"] }
          data_mapping: { type: object, description: "Field mapping requirements" }
          caching_strategy: { type: string, enum: ["none", "basic", "advanced", "custom"] }
        required: ["api_type", "integration_pattern"]
      output_schema:
        type: object
        properties:
          service_implementation: { type: string, description: "Drupal service class code" }
          plugin_definition: { type: object, description: "Plugin configuration and classes" }
          routing_config: { type: object, description: "Routing and controller setup" }
          cache_implementation: { type: string, description: "Caching layer code" }
          security_measures: { type: array, items: { type: string } }
      frameworks: ["drupal", "mcp", "langchain"]
      sla: "99.8%"
      
    - name: drupal_performance_optimization
      description: Analyze and optimize Drupal site performance
      input_schema:
        type: object
        properties:
          analysis_type: { type: string, enum: ["database", "caching", "code", "frontend", "full"] }
          current_metrics: { type: object, description: "Current performance measurements" }
          target_metrics: { type: object, description: "Target performance goals" }
          constraints: { type: array, items: { type: string }, description: "Optimization constraints" }
        required: ["analysis_type"]
      output_schema:
        type: object
        properties:
          optimization_plan: { type: string, description: "Detailed optimization strategy" }
          code_changes: { type: object, description: "Required code modifications" }
          configuration_updates: { type: object, description: "Config changes needed" }
          expected_improvements: { type: object, description: "Performance improvement estimates" }
          implementation_priority: { type: array, items: { type: string } }
      frameworks: ["drupal", "mcp", "crewai"]
      sla: "99.9%"
      
    - name: drupal_security_audit
      description: Conduct comprehensive security audits and implement protections
      input_schema:
        type: object
        properties:
          audit_scope: { type: string, enum: ["module", "site", "custom_code", "configuration"] }
          compliance_frameworks: { type: array, items: { type: string } }
          security_level: { type: string, enum: ["basic", "enterprise", "government"] }
          include_penetration_testing: { type: boolean, default: false }
        required: ["audit_scope"]
      output_schema:
        type: object
        properties:
          vulnerability_report: { type: object, description: "Identified security issues" }
          remediation_plan: { type: string, description: "Security fix implementation plan" }
          hardening_recommendations: { type: array, items: { type: string } }
          compliance_status: { type: object, description: "Compliance framework adherence" }
          security_score: { type: number, minimum: 0, maximum: 1 }
      frameworks: ["drupal", "mcp", "security"]
      sla: "99.9%"

  # Advanced Drupal-specific context management
  context_management:
    max_tokens: 128000
    optimization:
      strategy: drupal_intelligent
      compression: true
      summarization: true
      deduplication: true
      drupal_context_preservation: true
    memory:
      type: persistent
      capacity: 5000
      storage: vector_db
      retention: "90d"
      drupal_knowledge_base: true
    
  # Multi-framework configuration with Drupal focus
  frameworks:
    mcp:
      enabled: true
      version: "2024-11-05"
      server_name: drupal-expert
      server_config:
        host: "0.0.0.0"
        port: 3210
        tools:
          - drupal_module_scaffold
          - drupal_api_client
          - drupal_performance_analyzer
          - drupal_security_scanner
        
    langchain:
      enabled: true
      version: "0.1.0"
      tool_type: drupal_structured
      async_support: true
      streaming: true
      memory_compatible: true
      chain_compatible: true
      custom_chains:
        - drupal_development_chain
        - drupal_debugging_chain
        
    crewai:
      enabled: true
      version: "0.1.0"
      role: senior_drupal_architect
      backstory: |
        Expert Drupal developer with 10+ years of experience building enterprise
        Drupal solutions, leading development teams, and architecting scalable
        web platforms. Specialized in performance optimization and security.
      delegation: true
      collaboration: team_lead
      skills:
        - drupal_architecture
        - performance_optimization
        - security_implementation
        - team_coordination
      
    drupal:
      enabled: true
      version: "10.x,11.x"
      core_apis:
        - entity_api
        - plugin_api
        - hook_system
        - service_container
        - cache_api
        - queue_api
        - database_api
      development_tools:
        - drush
        - composer
        - drupal_console
        - phpcs
        - phpstan
      testing_frameworks:
        - phpunit
        - nightwatch
        - behat
        
    llm_platform:
      enabled: true
      gateway_routing: true
      model_selection: "cost_optimized"
      token_optimization: "aggressive"
      caching_strategy: "intelligent"

  # UADP Discovery configuration for Drupal ecosystem
  discovery:
    uadp:
      enabled: true
      endpoints:
        - url: "https://api.drupal-llm-platform.com/v1/discovery"
          method: GET
          headers:
            X-Agent-Type: "drupal-expert"
            X-Capabilities: "module-dev,api-integration,performance,security"
        - url: "https://registry.drupal.org/api/agents"
          method: POST
          payload:
            agent_type: "drupal-expert"
            specialization: "full-stack-drupal"
      tags: ["drupal", "development", "architecture", "performance", "security", "enterprise"]
      priority: 90
      drupal_specific:
        module_compatibility: ["10.x", "11.x"]
        api_support: ["entity", "plugin", "hook", "service"]
        development_tier: "expert"
        
  # Enterprise integration with Drupal ecosystem
  integration:
    drupal_platform:
      composer_integration: true
      drush_compatibility: true
      drupal_console_support: true
      
    authentication:
      type: jwt
      config:
        issuer: https://auth.drupal-platform.com
        audience: drupal-expert
        algorithms: ["RS256", "ES256"]
        drupal_session_integration: true
    
    rate_limiting:
      enabled: true
      requests_per_minute: 500
      burst: 250
      by_user: true
      drupal_cache_integration: true
      
    timeout:
      request: 120000
      connection: 15000
      drupal_batch_operations: 300000

  # Comprehensive monitoring for Drupal operations
  monitoring:
    metrics:
      enabled: true
      export: prometheus
      endpoint: /metrics
      interval: 15
      custom_metrics:
        - drupal_modules_created
        - api_integrations_completed
        - performance_improvements
        - security_audits_passed
        - developer_satisfaction
        
    drupal_specific_monitoring:
      module_performance: true
      hook_execution_time: true
      database_query_analysis: true
      cache_hit_rates: true
      
    logging:
      level: info
      format: json
      destinations:
        - stdout
        - drupal_logs
        - elasticsearch
      sampling_rate: 1.0
      drupal_integration: true
      
    alerting:
      enabled: true
      channels: ["email", "slack", "drupal_notifications"]
      thresholds:
        error_rate: 0.001
        response_time: 8000
        availability: 0.999
        code_quality_score: 0.95

  # Enhanced security for Drupal development
  security:
    authentication:
      methods: ["jwt", "drupal_session", "api_key"]
      required: true
      drupal_integration: true
      
    authorization:
      model: rbac
      roles: ["developer", "architect", "admin", "auditor"]
      permissions:
        developer: ["read", "create_modules", "api_integrate"]
        architect: ["read", "create_modules", "optimize", "audit", "security_scan"]
        admin: ["all_permissions"]
        auditor: ["read", "audit", "security_scan"]
        
    drupal_security:
      code_scanning: true
      dependency_checking: true
      hook_security_validation: true
      input_sanitization_enforcement: true
      
    secrets_management:
      provider: vault
      path: /secret/drupal-expert
      auto_rotation: true
      drupal_key_integration: true

  # Compliance framework with Drupal standards
  compliance:
    frameworks:
      - drupal_coding_standards
      - drupal_security_standards
      - iso_42001
      - gdpr
      - accessibility_wcag
      
    certification_level: governed
    audit_trail: true
    code_quality_enforcement: true
    
    drupal_compliance:
      coding_standards: "Drupal,DrupalPractice"
      security_review: mandatory
      performance_audit: required
      accessibility_testing: wcag_aa
      
    data_handling:
      encryption: both
      retention: "365d"
      anonymization: true
      drupal_privacy_integration: true

  # API specification for Drupal operations
  api:
    specification: ./openapi-drupal-expert.yaml
    base_url: https://api.drupal-platform.com/v1
    version: 1.0.0
    endpoints:
      - path: /modules/create
        method: POST
        description: Create new Drupal module
      - path: /api/integrate
        method: POST
        description: Create API integration
      - path: /performance/analyze
        method: POST
        description: Analyze and optimize performance
      - path: /security/audit
        method: POST
        description: Conduct security audit
    
  # Performance optimization with Drupal focus
  performance:
    token_optimization:
      enabled: true
      target_savings: "65-75%"
      strategies:
        - drupal_context_compression
        - code_pattern_caching
        - api_response_optimization
        - development_workflow_streamlining
        
    caching:
      enabled: true
      ttl: 7200
      levels: ["request", "computation", "result", "context", "drupal_cache"]
      storage: redis
      drupal_cache_integration: true
      
    scaling:
      auto_scale: true
      min_replicas: 2
      max_replicas: 20
      target_cpu: 70
      target_memory: 75
      drupal_load_balancing: true

status:
  phase: ready
  conditions:
    - type: ready
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
    - type: healthy
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
    - type: compliant
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
    - type: drupal_certified
      status: "true"
      last_transition_time: "2025-09-02T12:00:00Z"
      
  deployment:
    replicas: 2
    available_replicas: 2
    ready_replicas: 2
    
  last_updated: "2025-09-02T12:00:00Z"
  drupal_version_compatibility: ["10.x", "11.x"]