# ============================================================================
# OSSA Security Tiers - Access Control Levels
# ============================================================================
# Defines security tiers for agent operations.
# Agents declare their required tier; workspace enforces permissions.
# ============================================================================

apiVersion: ossa.dev/v1
kind: SecurityPolicy
metadata:
  name: ossa-security-tiers
  version: "1.0.0"

spec:
  tiers:
    # Standard tier - Most agents operate here
    standard:
      level: 1
      permissions:
        - read:source
        - read:docs
        - read:tests
        - write:generated
        - execute:lint
        - execute:test
      restrictions:
        - no-network-access
        - no-credential-access
        - sandbox-execution
      audit: minimal

    # Elevated tier - CI/CD and security tools
    elevated:
      level: 2
      permissions:
        - read:*
        - write:source
        - write:tests
        - execute:build
        - execute:deploy-preview
        - access:git
      restrictions:
        - no-production-access
        - no-credential-modification
        - logged-execution
      audit: detailed
      requires:
        - workspace-approval

    # Admin tier - Full access (human oversight required)
    admin:
      level: 3
      permissions:
        - read:*
        - write:*
        - execute:*
        - access:credentials
        - access:production
      restrictions:
        - human-in-the-loop
        - full-audit-trail
      audit: full
      requires:
        - human-approval
        - mfa-verification

  agent_tiers:
    # Map agents to their required tiers
    code-assistant: standard
    doc-generator: standard
    test-generator: standard
    data-transformer: standard
    code-reviewer: elevated
    security-scanner: elevated
    ci-pipeline: elevated
    workflow-orchestrator: elevated
    content-writer: standard
    compliance-validator: elevated

  escalation:
    # How agents can request elevated access
    method: explicit-request
    approval:
      standard_to_elevated: workspace-policy
      elevated_to_admin: human-approval
    timeout: 300s  # 5 minute window for elevated operations
