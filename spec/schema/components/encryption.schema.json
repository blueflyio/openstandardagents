{
  "$id": "https://ossa.dev/schema/components/encryption.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OSSA Encryption Configuration",
  "description": "Encryption settings for agent state storage",
  "type": "object",
  "properties": {
    "enabled": {
      "type": "boolean",
      "default": false,
      "description": "Enable encryption for state storage"
    },
    "algorithm": {
      "type": "string",
      "enum": ["AES-256-GCM", "AES-256-CBC", "ChaCha20-Poly1305"],
      "default": "AES-256-GCM",
      "description": "Encryption algorithm"
    },
    "key_management": {
      "type": "object",
      "description": "Key management configuration",
      "properties": {
        "provider": {
          "type": "string",
          "enum": ["vault", "aws-kms", "gcp-kms", "azure-keyvault", "local"],
          "description": "Key management provider"
        },
        "key_id": {
          "type": "string",
          "description": "Key identifier in the provider"
        },
        "key_version": {
          "type": "string",
          "description": "Specific key version to use"
        },
        "rotation_days": {
          "type": "integer",
          "minimum": 1,
          "default": 90,
          "description": "Key rotation interval in days"
        },
        "auto_rotate": {
          "type": "boolean",
          "default": true,
          "description": "Enable automatic key rotation"
        }
      },
      "required": ["provider"]
    },
    "at_rest": {
      "type": "object",
      "description": "Encryption at rest settings",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable encryption at rest"
        },
        "scope": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["state", "logs", "artifacts", "all"]
          },
          "default": ["state"],
          "description": "What data to encrypt at rest"
        }
      }
    },
    "in_transit": {
      "type": "object",
      "description": "Encryption in transit settings",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable encryption in transit"
        },
        "tls_version": {
          "type": "string",
          "enum": ["1.2", "1.3"],
          "default": "1.3",
          "description": "Minimum TLS version"
        },
        "verify_certificates": {
          "type": "boolean",
          "default": true,
          "description": "Verify TLS certificates"
        },
        "client_cert_required": {
          "type": "boolean",
          "default": false,
          "description": "Require client certificates (mTLS)"
        }
      }
    },
    "compliance": {
      "type": "object",
      "description": "Compliance-related encryption settings",
      "properties": {
        "fips_mode": {
          "type": "boolean",
          "default": false,
          "description": "Use FIPS 140-2 compliant algorithms"
        },
        "audit_logging": {
          "type": "boolean",
          "default": true,
          "description": "Log encryption operations"
        }
      }
    }
  },
  "additionalProperties": false
}
