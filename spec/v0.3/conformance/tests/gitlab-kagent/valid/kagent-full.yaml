apiVersion: ossa/v0.3.5
kind: Agent
metadata:
  name: kagent-full-test-agent
  description: Full GitLab Kagent configuration
  version: "1.0.0"
spec:
  role: assistant
  type: service
  identity:
    id: kagent-full-test-agent
    version: "1.0.0"
  completion:
    criteria:
      - type: task_completed
        description: Successfully completed task
    timeout_ms: 300000
  checkpointing:
    enabled: true
    interval_ms: 45000
    strategy: incremental
  monitoring:
    metrics:
      enabled: true
      interval_ms: 30000
    alerts:
      enabled: true
      channels: ["email", "slack", "pagerduty"]
  security:
    authentication:
      required: true
      method: oauth2
    authorization:
      rbac: true
      policies: ["admin", "developer", "viewer"]
    encryption:
      at_rest: true
      in_transit: true
  capabilities:
    - name: code_review
      description: Review code changes
    - name: ci_management
      description: Manage CI/CD pipelines
  llm:
    provider: anthropic
    model: claude-3-5-sonnet-20241022
  extensions:
    kagent:
      enabled: true
      version: "1.0.0"
      kubernetes:
        namespace: kagent-production
        resourceLimits:
          cpu: "2000m"
          memory: "4Gi"
          storage: "10Gi"
        requests:
          cpu: "1000m"
          memory: "2Gi"
      gitlab_integration:
        enabled: true
        url: https://gitlab.com
        ci_cd:
          enabled: true
          auto_trigger: true
        issues:
          enabled: true
          auto_label: true
        merge_requests:
          enabled: true
          auto_review: true
        pipelines:
          enabled: true
          auto_retry: true
      deployment:
        strategy: blue-green
        replicas: 3
      scaling:
        auto: true
        min_replicas: 2
        max_replicas: 10
        target_cpu_utilization: 70
      observability:
        monitoring:
          enabled: true
          dashboard_url: https://grafana.example.com
        traces:
          enabled: true
          exporter: jaeger
        metrics:
          enabled: true
          exporter: prometheus
    moe:
      enabled: true
      routing_strategy: least_cost
      models:
        - provider: anthropic
          model: claude-3-5-haiku-20241022
          use_case: simple_queries
        - provider: anthropic
          model: claude-3-5-sonnet-20241022
          use_case: complex_analysis
    bat:
      enabled: true
      criteria:
        - type: cost
          weight: 0.4
        - type: performance
          weight: 0.3
        - type: quality
          weight: 0.3
    feedback_loops:
      enabled: true
      mechanisms:
        - type: user_feedback
          collection_method: inline
        - type: performance_metrics
          interval_ms: 60000
