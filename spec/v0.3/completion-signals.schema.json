{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://openstandardagents.org/schemas/v0.3.5/completion-signals.json",
  "title": "OSSA v0.3.5 Completion Signals Schema",
  "description": "Standardized agent completion status signals for workflow orchestration",
  "type": "object",
  "definitions": {
    "CompletionSignal": {
      "type": "string",
      "enum": ["continue", "complete", "blocked", "escalate", "checkpoint"],
      "description": "Standardized agent completion status",
      "examples": ["complete", "continue", "blocked"]
    },
    "CompletionMetadata": {
      "type": "object",
      "description": "Metadata associated with completion signal",
      "properties": {
        "signal": {
          "$ref": "#/definitions/CompletionSignal"
        },
        "iteration_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of reasoning iterations completed"
        },
        "tokens_used": {
          "type": "integer",
          "minimum": 0,
          "description": "Total tokens consumed"
        },
        "cost_usd": {
          "type": "number",
          "minimum": 0,
          "description": "Total cost in USD"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in completion (0-1)"
        },
        "next_action": {
          "type": "string",
          "description": "Suggested next action"
        },
        "artifacts": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["type", "uri"],
            "properties": {
              "type": {
                "type": "string",
                "enum": ["file", "url", "data", "checkpoint"]
              },
              "uri": {
                "type": "string",
                "format": "uri"
              },
              "checksum": {
                "type": "string",
                "description": "Content checksum for integrity verification"
              },
              "mime_type": {
                "type": "string"
              },
              "size_bytes": {
                "type": "integer"
              }
            }
          }
        },
        "error": {
          "type": "object",
          "properties": {
            "code": {
              "type": "string"
            },
            "message": {
              "type": "string"
            },
            "recoverable": {
              "type": "boolean",
              "default": false
            }
          }
        }
      },
      "required": ["signal"]
    },
    "CompletionSignalConfiguration": {
      "type": "object",
      "description": "Agent completion signal configuration",
      "properties": {
        "default_signal": {
          "$ref": "#/definitions/CompletionSignal",
          "default": "complete"
        },
        "signals": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["signal"],
            "properties": {
              "signal": {
                "$ref": "#/definitions/CompletionSignal"
              },
              "condition": {
                "type": "string",
                "description": "Condition expression for signal (e.g., 'iteration_count < max_iterations')"
              },
              "priority": {
                "type": "integer",
                "description": "Signal priority (higher = evaluated first)"
              }
            }
          }
        },
        "max_iterations": {
          "type": "integer",
          "default": 10,
          "description": "Maximum iterations before forced completion"
        },
        "timeout_seconds": {
          "type": "integer",
          "description": "Maximum execution time before timeout signal"
        }
      }
    }
  },
  "properties": {
    "completion": {
      "$ref": "#/definitions/CompletionSignalConfiguration"
    }
  }
}
