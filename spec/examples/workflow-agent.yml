ossaVersion: "1.0"

agent:
  # Identity
  id: workflow-orchestrator
  name: Workflow Orchestration Agent
  version: 2.0.0
  description: |
    Advanced workflow orchestration agent that coordinates multi-step processes,
    manages agent swarms, and provides intelligent task routing.
  role: orchestration
  tags:
    - workflow
    - orchestration
    - multi-agent
    - coordination

  # Runtime
  runtime:
    type: k8s
    image: ossa/workflow-orchestrator:2.0.0
    requirements:
      node: ">=20.0.0"
      packages:
        - temporal-sdk
        - bullmq
        - ioredis
    resources:
      cpu: "2000m"
      memory: "2Gi"
      gpu: false
    health_check:
      type: http
      endpoint: /health
      port: 3500

  # Capabilities
  capabilities:
    - name: execute_workflow
      description: Execute multi-step workflow
      input_schema:
        type: object
        required:
          - workflow_definition
        properties:
          workflow_definition:
            type: object
            properties:
              name:
                type: string
              steps:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    agent_id:
                      type: string
                    capability:
                      type: string
                    input:
                      type: object
                    depends_on:
                      type: array
                      items:
                        type: string
          context:
            type: object
      output_schema:
        type: object
        properties:
          execution_id:
            type: string
          status:
            type: string
            enum: [queued, running, completed, failed]
          results:
            type: array
            items:
              type: object
      timeout_seconds: 3600
      retry_policy:
        max_attempts: 3
        backoff: exponential

    - name: spawn_agent_swarm
      description: Spawn multiple agents to work in parallel
      input_schema:
        type: object
        required:
          - agent_count
          - tasks
        properties:
          agent_count:
            type: integer
            minimum: 1
            maximum: 100
          tasks:
            type: array
            items:
              type: object
          strategy:
            type: string
            enum: [round-robin, capability-match, load-balanced]
            default: load-balanced
      output_schema:
        type: object
        properties:
          swarm_id:
            type: string
          agents:
            type: array
            items:
              type: object
              properties:
                agent_id:
                  type: string
                assigned_tasks:
                  type: integer
          estimated_completion:
            type: string
            format: date-time
      timeout_seconds: 60

    - name: coordinate_multi_agent_task
      description: Coordinate task across multiple agents
      input_schema:
        type: object
        required:
          - task_description
          - agents
        properties:
          task_description:
            type: string
          agents:
            type: array
            items:
              type: string
          coordination_mode:
            type: string
            enum: [sequential, parallel, hierarchical]
            default: parallel
      output_schema:
        type: object
        properties:
          coordination_id:
            type: string
          agent_assignments:
            type: array
          status:
            type: string

  # Policies
  policies:
    compliance:
      - soc2-type1
    data_residency:
      - US
      - EU
      - CA
    encryption: true
    audit: true
    pii_handling: none

  # Integration
  integration:
    protocol: grpc
    endpoints:
      base_url: workflow-orchestrator:3500
      health: /health
      metrics: /metrics
      openapi: /api/docs
    auth:
      type: jwt
      config:
        issuer: https://auth.ossa.io
        audience: workflow-orchestrator
    rate_limits:
      requests_per_second: 100
      burst: 50

  # Monitoring
  monitoring:
    traces: true
    metrics: true
    logs: true
    health_check: http://localhost:3500/health
    phoenix_arise:
      enabled: true
      project: ossa-workflows
      export_interval_seconds: 30

  # Dependencies
  dependencies:
    required:
      - agent_id: agent-router
        min_version: "1.0.0"
      - agent_id: agent-protocol
        min_version: "1.0.0"
      - agent_id: agent-tracer
        min_version: "1.0.0"
    optional:
      - agent_id: agent-brain
        fallback: Workflows without context enrichment
      - agent_id: compliance-engine
        fallback: No policy validation

  # Metadata
  metadata:
    author: OSSA Workflow Team
    maintainer: workflows@ossa.io
    homepage: https://ossa.io/agents/workflow-orchestrator
    repository: https://github.com/ossa-agents/workflow-orchestrator
    documentation: https://docs.ossa.io/agents/workflow-orchestrator
    license: Apache-2.0
    keywords:
      - workflow
      - orchestration
      - multi-agent
      - swarm
      - coordination
      - temporal
