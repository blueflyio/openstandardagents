# OAAS Agent Enterprise Schema v1.1
# Comprehensive enterprise agent configuration schema
# Based on real-world enterprise patterns and production requirements

type: object
required:
  - apiVersion
  - kind
  - metadata
  - spec
properties:
  apiVersion:
    type: string
    pattern: '^openapi-ai-agents/v[0-9]+\.[0-9]+\.[0-9]+$'
    description: OAAS API version
    example: "openapi-ai-agents/v0.1.1"
    
  kind:
    type: string
    enum: [Agent]
    description: Resource type
    
  metadata:
    type: object
    required:
      - name
      - version
    properties:
      name:
        type: string
        pattern: '^[a-z0-9-]+$'
        minLength: 3
        maxLength: 50
        description: Agent identifier
        
      version:
        type: string
        pattern: '^[0-9]+\.[0-9]+\.[0-9]+$'
        description: Agent version (semantic versioning)
        
      created:
        type: string
        format: date
        description: Creation date
        
      updated:
        type: string
        format: date
        description: Last update date
        
      description:
        type: string
        maxLength: 500
        description: Agent purpose and capabilities
        
      annotations:
        type: object
        description: OAAS and framework annotations
        properties:
          # OAAS core annotations
          oaas/agent-level:
            type: string
            enum: ["0", "1", "2", "3", "4"]
            description: Agent maturity level
            
          oaas/compliance-level:
            type: string
            enum: ["bronze", "silver", "gold"]
            default: "bronze"
            
          oaas/framework-compatibility:
            type: string
            description: Compatible frameworks (comma-separated)
            
          oaas/last-validated:
            type: string
            format: date-time
            description: Last validation timestamp
            
          # Universal framework support
          uadp/discoverable:
            type: string
            enum: ["true", "false"]
            default: "true"
            
          uadp/orchestration-capable:
            type: string
            enum: ["true", "false"]
            default: "false"
            
          uadp/cross-project-routing:
            type: string
            enum: ["enabled", "disabled"]
            default: "disabled"
            
          # Enterprise annotations
          enterprise/certified:
            type: string
            enum: ["true", "false"]
            default: "false"
            
          enterprise/security-cleared:
            type: string
            enum: ["true", "false"]
            default: "false"
            
          enterprise/compliance-validated:
            type: string
            enum: ["true", "false"]
            default: "false"
            
          # Performance and optimization
          performance/token-optimized:
            type: string
            enum: ["true", "false"]
            default: "false"
            
          performance/cache-enabled:
            type: string
            enum: ["true", "false"]
            default: "false"
            
          performance/auto-scaling:
            type: string
            enum: ["true", "false"]
            default: "false"
            
        additionalProperties:
          type: string
          
      labels:
        type: object
        description: Classification and filtering labels
        properties:
          environment:
            type: string
            enum: ["development", "staging", "production"]
            
          tier:
            type: string
            enum: ["basic", "standard", "enterprise"]
            
          domain:
            type: string
            description: Business domain
            
          team:
            type: string
            description: Owning team
            
          compliance:
            type: string
            description: Compliance frameworks (comma-separated)
            
        additionalProperties:
          type: string
          
  spec:
    type: object
    required:
      - agent
    properties:
      agent:
        type: object
        required:
          - name
          - expertise
        properties:
          name:
            type: string
            description: Agent display name
            
          expertise:
            type: string
            maxLength: 500
            description: Agent's primary domain expertise
            
          description:
            type: string
            maxLength: 2000
            description: Detailed agent description
            
      capabilities:
        type: array
        minItems: 1
        items:
          oneOf:
            - type: string
              description: Simple capability description (Level 0-1)
            - type: object
              description: Structured capability (Level 2+)
              required:
                - name
                - description
              properties:
                name:
                  type: string
                  pattern: '^[a-z0-9_]+$'
                  description: Capability identifier
                  
                description:
                  type: string
                  maxLength: 200
                  description: Capability description
                  
                input_schema:
                  type: string
                  description: Path to input schema file
                  
                output_schema:
                  type: string
                  description: Path to output schema file
                  
                frameworks:
                  type: array
                  items:
                    type: string
                    enum: ["langchain", "crewai", "openai", "anthropic", "google", "autogen", "mcp"]
                  description: Framework compatibility for this capability
                  
                compliance:
                  type: array
                  items:
                    type: string
                    enum: ["iso-42001", "nist-ai-rmf", "eu-ai-act", "sox", "hipaa", "gdpr"]
                  description: Compliance frameworks for this capability
                  
                sla:
                  type: string
                  pattern: '^[0-9]+(\.[0-9]+)?%$'
                  description: Service level agreement (e.g., "99.9%")
                  
                cost_estimate:
                  type: object
                  properties:
                    tokens_per_request:
                      type: integer
                      minimum: 1
                      
                    cost_per_request:
                      type: number
                      minimum: 0
                      
        description: Agent capabilities
        
      api:
        type: object
        description: API specification
        properties:
          openapi:
            type: string
            enum: ["3.0.0", "3.0.1", "3.0.2", "3.0.3", "3.1.0"]
            description: OpenAPI specification version
            
          specification:
            type: string
            description: Path to OpenAPI specification file
            
          endpoints:
            type: array
            items:
              type: string
            description: API endpoints (if not using OpenAPI spec)
            
          base_url:
            type: string
            format: uri
            description: Base URL for API endpoints
            
          authentication:
            type: object
            properties:
              type:
                type: string
                enum: ["none", "api_key", "bearer", "basic", "oauth2", "mtls"]
                default: "api_key"
                
              header:
                type: string
                description: Authentication header name
                
              scheme:
                type: string
                description: Authentication scheme
                
      protocols:
        type: object
        description: Protocol support configuration
        properties:
          mcp:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              server_config:
                type: object
                properties:
                  name:
                    type: string
                    
                  version:
                    type: string
                    
                  tools:
                    type: array
                    items:
                      type: object
                      
              bridge_config:
                type: object
                description: MCP bridge specific configuration
                
          uadp:
            type: object
            properties:
              enabled:
                type: boolean
                default: true
                
              discovery_metadata:
                type: object
                description: UADP discovery metadata
                
              orchestration_endpoints:
                type: array
                items:
                  type: string
                description: Endpoints for orchestration
                
          a2a:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              communication_protocols:
                type: array
                items:
                  type: string
                  enum: ["http", "grpc", "websocket", "message_queue"]
                  
      frameworks:
        type: object
        description: Framework compatibility configurations
        properties:
          langchain:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              tools_format:
                type: string
                enum: ["function_calling", "tool_calling", "structured_output"]
                default: "function_calling"
                
              chain_type:
                type: string
                enum: ["llm", "conversation", "sequential", "map_reduce"]
                
              memory_type:
                type: string
                enum: ["buffer", "summary", "conversation_kg", "vector_store"]
                
          crewai:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              role:
                type: string
                maxLength: 100
                description: Agent role in CrewAI
                
              goal:
                type: string
                maxLength: 200
                description: Agent goal
                
              backstory:
                type: string
                maxLength: 500
                description: Agent backstory
                
              tools:
                type: array
                items:
                  type: string
                description: Available tools
                
              delegation:
                type: boolean
                default: false
                description: Can delegate to other agents
                
          openai:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              assistant_config:
                type: object
                properties:
                  model:
                    type: string
                    
                  instructions:
                    type: string
                    
                  tools:
                    type: array
                    items:
                      type: object
                      
              function_calling:
                type: boolean
                default: true
                
          anthropic:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              model:
                type: string
                enum: ["claude-3-opus", "claude-3-sonnet", "claude-3-haiku"]
                
              tool_use:
                type: boolean
                default: true
                
              system_prompt:
                type: string
                maxLength: 2000
                
          google:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              vertex_ai:
                type: object
                properties:
                  model:
                    type: string
                    
                  location:
                    type: string
                    
                  project_id:
                    type: string
                    
          autogen:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              agent_type:
                type: string
                enum: ["assistant", "user_proxy", "group_chat_manager"]
                
              conversation_config:
                type: object
                properties:
                  max_turns:
                    type: integer
                    
                  termination_condition:
                    type: string
                    
      resources:
        type: object
        description: Resource requirements (Kubernetes-style)
        properties:
          requests:
            type: object
            properties:
              cpu:
                type: string
                pattern: '^[0-9]+m?$'
                description: CPU request (e.g., "100m", "1")
                
              memory:
                type: string
                pattern: '^[0-9]+[KMGT]i?$'
                description: Memory request (e.g., "128Mi", "1Gi")
                
              gpu:
                type: integer
                minimum: 0
                description: GPU request
                
          limits:
            type: object
            properties:
              cpu:
                type: string
                pattern: '^[0-9]+m?$'
                description: CPU limit
                
              memory:
                type: string
                pattern: '^[0-9]+[KMGT]i?$'
                description: Memory limit
                
              gpu:
                type: integer
                minimum: 0
                description: GPU limit
                
          storage:
            type: object
            properties:
              size:
                type: string
                pattern: '^[0-9]+[KMGT]i?$'
                description: Storage size
                
              class:
                type: string
                description: Storage class
                
      monitoring:
        type: object
        description: Monitoring and observability configuration
        properties:
          metrics:
            type: object
            properties:
              enabled:
                type: boolean
                default: true
                
              port:
                type: integer
                minimum: 1024
                maximum: 65535
                default: 9090
                
              path:
                type: string
                default: "/metrics"
                
              custom_metrics:
                type: array
                items:
                  type: string
                description: Custom metrics to collect
                
          logging:
            type: object
            properties:
              level:
                type: string
                enum: ["debug", "info", "warn", "error"]
                default: "info"
                
              format:
                type: string
                enum: ["json", "text"]
                default: "json"
                
              structured:
                type: boolean
                default: true
                
          tracing:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              provider:
                type: string
                enum: ["jaeger", "zipkin", "datadog"]
                
              sampling_rate:
                type: number
                minimum: 0
                maximum: 1
                default: 0.1
                
          health_checks:
            type: object
            properties:
              liveness:
                type: object
                properties:
                  path:
                    type: string
                    default: "/health/live"
                    
                  interval:
                    type: integer
                    default: 30
                    description: Check interval in seconds
                    
              readiness:
                type: object
                properties:
                  path:
                    type: string
                    default: "/health/ready"
                    
                  interval:
                    type: integer
                    default: 10
                    description: Check interval in seconds
                    
      security:
        type: object
        description: Security configuration
        properties:
          authentication:
            type: object
            properties:
              required:
                type: boolean
                default: false
                
              methods:
                type: array
                items:
                  type: string
                  enum: ["api_key", "jwt", "oauth2", "mtls", "basic"]
                  
          authorization:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              model:
                type: string
                enum: ["rbac", "abac"]
                default: "rbac"
                
              policies:
                type: array
                items:
                  type: object
                  properties:
                    role:
                      type: string
                      
                    permissions:
                      type: array
                      items:
                        type: string
                        
          encryption:
            type: object
            properties:
              in_transit:
                type: boolean
                default: true
                
              at_rest:
                type: boolean
                default: false
                
          network:
            type: object
            properties:
              allowed_origins:
                type: array
                items:
                  type: string
                description: CORS allowed origins
                
              rate_limiting:
                type: object
                properties:
                  enabled:
                    type: boolean
                    default: false
                    
                  requests_per_minute:
                    type: integer
                    default: 60
                    
      compliance:
        type: object
        description: Enterprise compliance configuration
        properties:
          frameworks:
            type: array
            items:
              type: string
              enum: ["iso_42001", "nist_ai_rmf", "eu_ai_act", "sox", "hipaa", "gdpr", "ccpa"]
            description: Applicable compliance frameworks
            
          certifications:
            type: array
            items:
              type: object
              properties:
                framework:
                  type: string
                  
                level:
                  type: string
                  enum: ["bronze", "silver", "gold"]
                  
                valid_until:
                  type: string
                  format: date
                  
                certificate_id:
                  type: string
                  
          data_handling:
            type: object
            properties:
              classification:
                type: string
                enum: ["public", "internal", "confidential", "restricted"]
                default: "internal"
                
              retention:
                type: string
                pattern: '^[0-9]+[dmy]$'
                default: "90d"
                description: Data retention period
                
              encryption_required:
                type: boolean
                default: false
                
              anonymization:
                type: boolean
                default: false
                
          audit:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              level:
                type: string
                enum: ["basic", "detailed", "comprehensive", "forensic"]
                default: "basic"
                
              retention:
                type: string
                pattern: '^[0-9]+[dmy]$'
                default: "7y"
                
      deployment:
        type: object
        description: Deployment configuration
        properties:
          environments:
            type: array
            items:
              type: string
              enum: ["development", "staging", "production"]
            description: Supported deployment environments
            
          strategy:
            type: string
            enum: ["recreate", "rolling_update", "blue_green", "canary"]
            default: "rolling_update"
            
          scaling:
            type: object
            properties:
              min_replicas:
                type: integer
                minimum: 1
                default: 1
                
              max_replicas:
                type: integer
                minimum: 1
                default: 10
                
              auto_scale:
                type: boolean
                default: false
                
              target_cpu_utilization:
                type: integer
                minimum: 1
                maximum: 100
                default: 70
                
          rollout:
            type: object
            properties:
              max_unavailable:
                type: string
                pattern: '^([0-9]+%?|[0-9]+)$'
                default: "25%"
                
              max_surge:
                type: string
                pattern: '^([0-9]+%?|[0-9]+)$'
                default: "25%"
                
      data:
        type: object
        description: Agent data configuration
        properties:
          training_data:
            type: string
            description: Path to training data
            
          knowledge_base:
            type: string
            description: Path to knowledge base
            
          examples:
            type: string
            description: Path to example interactions
            
          configurations:
            type: string
            description: Path to additional configurations
            
          vector_store:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              provider:
                type: string
                enum: ["pinecone", "weaviate", "qdrant", "chroma"]
                
              collection:
                type: string
                description: Vector collection name
                
              dimensions:
                type: integer
                minimum: 1
                description: Vector dimensions
                
      context_management:
        type: object
        description: Context and token management
        properties:
          max_tokens:
            type: integer
            minimum: 100
            maximum: 2000000
            default: 8000
            
          optimization:
            type: object
            properties:
              strategy:
                type: string
                enum: ["adaptive", "fixed", "progressive", "sliding_window"]
                default: "adaptive"
                
              compression:
                type: boolean
                default: true
                
              summarization:
                type: boolean
                default: false
                
              caching:
                type: boolean
                default: false
                
          memory:
            type: object
            properties:
              type:
                type: string
                enum: ["none", "short_term", "long_term", "persistent", "vector_memory"]
                default: "short_term"
                
              capacity:
                type: integer
                default: 10
                description: Memory capacity (conversations or documents)
                
              ttl:
                type: integer
                description: Memory TTL in seconds
                
      performance:
        type: object
        description: Performance configuration
        properties:
          timeout:
            type: integer
            minimum: 1000
            default: 30000
            description: Request timeout in milliseconds
            
          retry:
            type: object
            properties:
              enabled:
                type: boolean
                default: true
                
              max_attempts:
                type: integer
                default: 3
                
              backoff:
                type: string
                enum: ["linear", "exponential", "fixed"]
                default: "exponential"
                
              initial_delay:
                type: integer
                default: 1000
                description: Initial retry delay in milliseconds
                
          circuit_breaker:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              failure_threshold:
                type: integer
                default: 5
                
              reset_timeout:
                type: integer
                default: 60000
                description: Reset timeout in milliseconds
                
          caching:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              ttl:
                type: integer
                default: 3600
                description: Cache TTL in seconds
                
              strategy:
                type: string
                enum: ["lru", "lfu", "ttl"]
                default: "lru"