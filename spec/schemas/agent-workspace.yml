# OAAS Agent Workspace Schema v1.0
# Workspace-level configuration for multi-agent orchestration

type: object
required:
  - version
  - workspace
properties:
  version:
    type: string
    pattern: '^[0-9]+\.[0-9]+\.[0-9]+$'
    description: OAAS workspace schema version
    
  workspace:
    type: object
    required:
      - name
      - discovery
    properties:
      name:
        type: string
        description: Workspace identifier
        
      description:
        type: string
        description: Workspace purpose and capabilities
        
      discovery:
        type: object
        description: Agent discovery configuration
        properties:
          enabled:
            type: boolean
            default: true
            
          scan_paths:
            type: array
            items:
              type: string
            default: [".agents", "agents", "services/agents"]
            
          auto_register:
            type: boolean
            default: true
            description: Automatically register discovered agents
            
          refresh_interval:
            type: integer
            minimum: 60
            default: 300
            description: Discovery refresh interval in seconds
            
      orchestration:
        type: object
        description: Multi-agent orchestration rules
        properties:
          strategy:
            type: string
            enum: [sequential, parallel, adaptive, hierarchical]
            default: adaptive
            
          max_concurrent:
            type: integer
            minimum: 1
            default: 5
            
          timeout:
            type: integer
            minimum: 1000
            default: 30000
            description: Global timeout in milliseconds
            
          error_handling:
            type: string
            enum: [stop, continue, retry, fallback]
            default: retry
            
      registry:
        type: object
        description: Agent registry configuration
        properties:
          type:
            type: string
            enum: [local, redis, etcd, consul]
            default: local
            
          connection:
            type: string
            description: Registry connection string
            
          namespace:
            type: string
            default: oaas
            
      context:
        type: object
        description: Shared workspace context
        properties:
          environment:
            type: string
            enum: [development, staging, production]
            default: development
            
          variables:
            type: object
            additionalProperties:
              type: string
              
          resources:
            type: array
            items:
              type: object
              properties:
                type:
                  type: string
                  enum: [database, api, file, vector_store]
                name:
                  type: string
                connection:
                  type: string
                  
      bridges:
        type: array
        description: Protocol bridge configurations
        items:
          type: object
          required:
            - protocol
            - enabled
          properties:
            protocol:
              type: string
              enum: [mcp, langchain, crewai, autogen, custom]
            enabled:
              type: boolean
            config:
              type: object
              description: Protocol-specific configuration
              
      monitoring:
        type: object
        description: Workspace monitoring configuration
        properties:
          metrics:
            type: boolean
            default: true
          logging:
            type: object
            properties:
              level:
                type: string
                enum: [debug, info, warn, error]
                default: info
              destination:
                type: string
                enum: [console, file, syslog, elasticsearch]
                default: console
          telemetry:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
              endpoint:
                type: string
                format: uri