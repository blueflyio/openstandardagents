{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://open-standards-scalable-agents.org/schemas/v0.1.2/conformance-profile.json",
  "title": "OSSA Conformance Profile Schema",
  "description": "OSSA conformance profile defining requirements and validation rules",
  "type": "object",
  "required": ["apiVersion", "kind", "metadata", "spec"],
  "properties": {
    "apiVersion": {
      "type": "string",
      "const": "open-standards-scalable-agents/v0.1.2",
      "description": "OSSA API version"
    },
    "kind": {
      "type": "string",
      "const": "ConformanceProfile",
      "description": "Resource type"
    },
    "metadata": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
          "description": "Profile identifier"
        },
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+(-[a-zA-Z0-9]+)?$",
          "description": "Profile version"
        },
        "description": {
          "type": "string",
          "description": "Profile description"
        },
        "labels": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "properties": {
            "level": {
              "type": "string",
              "enum": ["core", "governed", "advanced"]
            },
            "domain": {
              "type": "string"
            }
          }
        }
      }
    },
    "spec": {
      "type": "object",
      "required": ["level", "requirements"],
      "properties": {
        "level": {
          "type": "string",
          "enum": ["core", "governed", "advanced"],
          "description": "Conformance level"
        },
        "requirements": {
          "type": "object",
          "properties": {
            "mandatory": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["id", "description", "validation"],
                "properties": {
                  "id": {
                    "type": "string",
                    "description": "Requirement identifier"
                  },
                  "description": {
                    "type": "string",
                    "description": "Requirement description"
                  },
                  "validation": {
                    "type": "object",
                    "required": ["type"],
                    "properties": {
                      "type": {
                        "type": "string",
                        "enum": ["schema", "custom", "api", "behavioral"]
                      },
                      "schema_path": {
                        "type": "string",
                        "description": "JSON Schema path for validation"
                      },
                      "validator": {
                        "type": "string",
                        "description": "Custom validator function/script"
                      },
                      "endpoint": {
                        "type": "string",
                        "description": "API endpoint for validation"
                      },
                      "test_suite": {
                        "type": "string",
                        "description": "Behavioral test suite"
                      }
                    }
                  },
                  "severity": {
                    "type": "string",
                    "enum": ["critical", "major", "minor"],
                    "default": "major"
                  }
                }
              }
            },
            "optional": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["id", "description"],
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "points": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Points awarded for compliance"
                  }
                }
              }
            }
          }
        },
        "scoring": {
          "type": "object",
          "properties": {
            "pass_threshold": {
              "type": "integer",
              "minimum": 0,
              "maximum": 100,
              "description": "Minimum score to pass conformance"
            },
            "weights": {
              "type": "object",
              "properties": {
                "mandatory": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1,
                  "default": 0.8
                },
                "optional": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1,
                  "default": 0.2
                }
              }
            }
          }
        },
        "framework_compatibility": {
          "type": "object",
          "properties": {
            "required": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["mcp", "langchain", "crewai", "openai", "anthropic", "autogen"]
              },
              "description": "Required framework support"
            },
            "recommended": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["mcp", "langchain", "crewai", "openai", "anthropic", "autogen"]
              },
              "description": "Recommended framework support"
            },
            "tests": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["framework", "test_type"],
                "properties": {
                  "framework": {
                    "type": "string",
                    "enum": ["mcp", "langchain", "crewai", "openai", "anthropic", "autogen"]
                  },
                  "test_type": {
                    "type": "string",
                    "enum": ["integration", "compatibility", "performance", "functional"]
                  },
                  "test_suite": {
                    "type": "string",
                    "description": "Test suite path or identifier"
                  }
                }
              }
            }
          }
        },
        "compliance_frameworks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["framework", "requirements"],
            "properties": {
              "framework": {
                "type": "string",
                "enum": ["iso_42001", "nist_ai_rmf", "eu_ai_act", "sox", "hipaa", "gdpr", "ccpa"]
              },
              "requirements": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": ["id", "description", "mandatory"],
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "description": {
                      "type": "string"
                    },
                    "mandatory": {
                      "type": "boolean"
                    },
                    "evidence_required": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "enum": ["documentation", "audit_logs", "test_results", "certificates", "policies"]
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "validation": {
          "type": "object",
          "properties": {
            "automated": {
              "type": "boolean",
              "default": true,
              "description": "Enable automated validation"
            },
            "continuous": {
              "type": "boolean",
              "default": false,
              "description": "Enable continuous validation"
            },
            "schedule": {
              "type": "string",
              "description": "Validation schedule (cron format)"
            },
            "timeout": {
              "type": "string",
              "pattern": "^[0-9]+[smh]$",
              "default": "5m",
              "description": "Validation timeout"
            },
            "retry": {
              "type": "object",
              "properties": {
                "max_attempts": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 5,
                  "default": 3
                },
                "delay": {
                  "type": "string",
                  "pattern": "^[0-9]+[smh]$",
                  "default": "30s"
                }
              }
            }
          }
        },
        "certification": {
          "type": "object",
          "properties": {
            "authority": {
              "type": "string",
              "description": "Certifying authority"
            },
            "validity_period": {
              "type": "string",
              "pattern": "^[0-9]+[ymwd]$",
              "description": "Certificate validity period"
            },
            "renewal_threshold": {
              "type": "string",
              "pattern": "^[0-9]+[dwmy]$",
              "description": "Time before expiry to trigger renewal"
            },
            "evidence_retention": {
              "type": "string",
              "pattern": "^[0-9]+[ymwd]$",
              "description": "Evidence retention period"
            }
          }
        }
      }
    }
  }
}