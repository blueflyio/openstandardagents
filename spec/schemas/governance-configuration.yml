# OAAS Governance Configuration Schema v1.1
# Comprehensive governance framework schema for enterprise compliance
# Based on real-world enterprise governance patterns

type: object
required:
  - apiVersion
  - kind
  - metadata
  - spec
properties:
  apiVersion:
    type: string
    pattern: '^openapi-ai-agents/v[0-9]+\.[0-9]+\.[0-9]+$'
    description: OAAS API version
    example: "openapi-ai-agents/v0.1.1"
    
  kind:
    type: string
    enum: [GovernanceConfiguration]
    description: Resource type
    
  metadata:
    type: object
    required:
      - name
      - version
    properties:
      name:
        type: string
        pattern: '^[a-z0-9-]+$'
        description: Governance configuration identifier
        
      version:
        type: string
        pattern: '^[0-9]+\.[0-9]+\.[0-9]+$'
        description: Configuration version
        
      description:
        type: string
        maxLength: 500
        description: Governance framework description
        
      created:
        type: string
        format: date
        description: Creation date
        
      updated:
        type: string
        format: date
        description: Last update date
        
      annotations:
        type: object
        description: Governance annotations
        properties:
          governance/maturity-level:
            type: string
            enum: ["initial", "managed", "defined", "quantified", "optimized"]
            description: Governance maturity level
            
          governance/certification-status:
            type: string
            enum: ["none", "in-progress", "active", "expired"]
            description: Certification status
            
          governance/next-audit:
            type: string
            format: date
            description: Next scheduled audit date
            
        additionalProperties:
          type: string
          
  spec:
    type: object
    required:
      - compliance
    properties:
      compliance:
        type: object
        description: Compliance frameworks configuration
        properties:
          iso_42001:
            type: object
            description: ISO 42001:2023 AI Management System
            properties:
              status:
                type: string
                enum: ["not_implemented", "in_progress", "implemented", "certified"]
                
              level:
                type: string
                enum: ["bronze", "silver", "gold"]
                
              certification_body:
                type: string
                description: Certification body name
                
              certificate_number:
                type: string
                description: Certificate identifier
                
              valid_until:
                type: string
                format: date
                description: Certificate expiration date
                
              requirements:
                type: object
                properties:
                  ai_management_system:
                    type: object
                    properties:
                      implemented:
                        type: boolean
                      documentation:
                        type: string
                        format: uri
                    additionalProperties: false
                    
                  risk_assessment:
                    type: object
                    properties:
                      implemented:
                        type: boolean
                      frequency:
                        type: string
                        enum: ["monthly", "quarterly", "semi-annually", "annually"]
                      last_assessment:
                        type: string
                        format: date
                      risk_register:
                        type: string
                        format: uri
                    additionalProperties: false
                    
                  performance_evaluation:
                    type: object
                    properties:
                      implemented:
                        type: boolean
                      metrics:
                        type: array
                        items:
                          type: string
                          enum: ["accuracy", "fairness", "transparency", "robustness", "reliability"]
                      reporting_frequency:
                        type: string
                        enum: ["weekly", "monthly", "quarterly"]
                    additionalProperties: false
                    
                  continual_improvement:
                    type: object
                    properties:
                      implemented:
                        type: boolean
                      improvement_log:
                        type: string
                        format: uri
                    additionalProperties: false
                    
                additionalProperties: false
                
              controls:
                type: array
                items:
                  type: object
                  required:
                    - control_id
                    - name
                    - status
                  properties:
                    control_id:
                      type: string
                      pattern: '^A\.[0-9]+\.[0-9]+$'
                      
                    name:
                      type: string
                      maxLength: 100
                      
                    status:
                      type: string
                      enum: ["not_implemented", "partially_compliant", "compliant", "not_applicable"]
                      
                    evidence:
                      type: string
                      format: uri
                      
                  additionalProperties: false
                  
            additionalProperties: false
            
          nist_ai_rmf:
            type: object
            description: NIST AI Risk Management Framework
            properties:
              status:
                type: string
                enum: ["not_implemented", "in_progress", "implemented"]
                
              version:
                type: string
                enum: ["1.0"]
                
              maturity_level:
                type: string
                enum: ["tier1", "tier2", "tier3", "tier4"]
                description: Implementation tier
                
              functions:
                type: object
                properties:
                  govern:
                    type: object
                    properties:
                      policies:
                        type: array
                        items:
                          type: object
                          properties:
                            name:
                              type: string
                            version:
                              type: string
                            approved:
                              type: string
                              format: date
                          additionalProperties: false
                          
                      roles:
                        type: object
                        additionalProperties:
                          type: array
                          items:
                            type: string
                            
                      accountability:
                        type: object
                        properties:
                          executive_sponsor:
                            type: string
                          program_owner:
                            type: string
                        additionalProperties: false
                        
                    additionalProperties: false
                    
                  map:
                    type: object
                    properties:
                      context:
                        type: object
                        properties:
                          business_context:
                            type: string
                            enum: ["not_documented", "partially_documented", "documented"]
                          technical_context:
                            type: string
                            enum: ["not_documented", "partially_documented", "documented"]
                          regulatory_context:
                            type: string
                            enum: ["not_documented", "partially_documented", "documented"]
                        additionalProperties: false
                        
                      risks:
                        type: object
                        properties:
                          identified_risks:
                            type: integer
                            minimum: 0
                          high_risks:
                            type: integer
                            minimum: 0
                          mitigated_risks:
                            type: integer
                            minimum: 0
                          accepted_risks:
                            type: integer
                            minimum: 0
                        additionalProperties: false
                        
                      requirements:
                        type: object
                        properties:
                          functional:
                            type: integer
                            minimum: 0
                          non_functional:
                            type: integer
                            minimum: 0
                          regulatory:
                            type: integer
                            minimum: 0
                        additionalProperties: false
                        
                    additionalProperties: false
                    
                  measure:
                    type: object
                    properties:
                      metrics:
                        type: array
                        items:
                          type: object
                          properties:
                            name:
                              type: string
                            target:
                              oneOf:
                                - type: number
                                - type: string
                            current:
                              oneOf:
                                - type: number
                                - type: string
                          additionalProperties: false
                          
                      testing:
                        type: object
                        properties:
                          unit_tests:
                            type: integer
                            minimum: 0
                          integration_tests:
                            type: integer
                            minimum: 0
                          security_tests:
                            type: integer
                            minimum: 0
                          bias_tests:
                            type: integer
                            minimum: 0
                        additionalProperties: false
                        
                      monitoring:
                        type: object
                        properties:
                          real_time:
                            type: boolean
                          anomaly_detection:
                            type: boolean
                          drift_detection:
                            type: boolean
                        additionalProperties: false
                        
                    additionalProperties: false
                    
                  manage:
                    type: object
                    properties:
                      controls:
                        type: object
                        properties:
                          preventive:
                            type: integer
                            minimum: 0
                          detective:
                            type: integer
                            minimum: 0
                          corrective:
                            type: integer
                            minimum: 0
                        additionalProperties: false
                        
                      incidents:
                        type: object
                        properties:
                          total_incidents:
                            type: integer
                            minimum: 0
                          resolved_incidents:
                            type: integer
                            minimum: 0
                          open_incidents:
                            type: integer
                            minimum: 0
                          mttr:
                            type: string
                            pattern: '^[0-9]+[smhd]$'
                            description: Mean time to resolution
                        additionalProperties: false
                        
                      improvements:
                        type: object
                        properties:
                          implemented:
                            type: integer
                            minimum: 0
                          in_progress:
                            type: integer
                            minimum: 0
                          planned:
                            type: integer
                            minimum: 0
                        additionalProperties: false
                        
                    additionalProperties: false
                    
                additionalProperties: false
                
            additionalProperties: false
            
          eu_ai_act:
            type: object
            description: EU AI Act Compliance
            properties:
              status:
                type: string
                enum: ["not_applicable", "assessment_required", "compliant", "non_compliant"]
                
              risk_category:
                type: string
                enum: ["minimal", "limited", "high_risk", "unacceptable"]
                
              system_type:
                type: string
                enum: ["ai_system", "general_purpose_ai", "foundation_model"]
                
              requirements:
                type: object
                properties:
                  transparency:
                    type: object
                    properties:
                      user_notification:
                        type: boolean
                      ai_disclosure:
                        type: boolean
                      documentation:
                        type: string
                        enum: ["none", "basic", "detailed", "public"]
                    additionalProperties: false
                    
                  human_oversight:
                    type: object
                    properties:
                      override_capability:
                        type: boolean
                      monitoring_dashboard:
                        type: boolean
                      kill_switch:
                        type: boolean
                    additionalProperties: false
                    
                  accuracy:
                    type: object
                    properties:
                      testing_required:
                        type: boolean
                      performance_thresholds:
                        type: boolean
                      continuous_monitoring:
                        type: boolean
                    additionalProperties: false
                    
                  robustness:
                    type: object
                    properties:
                      adversarial_testing:
                        type: boolean
                      stress_testing:
                        type: boolean
                      failover_mechanisms:
                        type: boolean
                    additionalProperties: false
                    
                  data_governance:
                    type: object
                    properties:
                      quality_assurance:
                        type: boolean
                      bias_mitigation:
                        type: boolean
                      privacy_protection:
                        type: boolean
                    additionalProperties: false
                    
                additionalProperties: false
                
              technical_documentation:
                type: object
                properties:
                  system_description:
                    type: string
                    format: uri
                  risk_assessment:
                    type: string
                    format: uri
                  testing_results:
                    type: string
                    format: uri
                additionalProperties: false
                
              conformity_assessment:
                type: object
                properties:
                  self_assessment:
                    type: string
                    enum: ["not_started", "in_progress", "completed"]
                  third_party_assessment:
                    type: string
                    enum: ["not_required", "scheduled", "completed"]
                  ce_marking:
                    type: string
                    enum: ["not_required", "pending", "approved"]
                additionalProperties: false
                
            additionalProperties: false
            
          sox:
            type: object
            description: Sarbanes-Oxley Act Compliance
            properties:
              applicable:
                type: boolean
                description: Whether SOX compliance is required
                
              status:
                type: string
                enum: ["not_applicable", "in_progress", "compliant", "non_compliant"]
                
              controls:
                type: object
                properties:
                  access_control:
                    type: object
                    properties:
                      implemented:
                        type: boolean
                      review_frequency:
                        type: string
                        enum: ["monthly", "quarterly", "semi-annually", "annually"]
                    additionalProperties: false
                    
                  change_management:
                    type: object
                    properties:
                      implemented:
                        type: boolean
                      approval_required:
                        type: boolean
                    additionalProperties: false
                    
                  audit_trail:
                    type: object
                    properties:
                      implemented:
                        type: boolean
                      retention:
                        type: string
                        pattern: '^[0-9]+[dmy]$'
                      immutable:
                        type: boolean
                    additionalProperties: false
                    
                additionalProperties: false
                
            additionalProperties: false
            
          hipaa:
            type: object
            description: Health Insurance Portability and Accountability Act
            properties:
              applicable:
                type: boolean
                
              status:
                type: string
                enum: ["not_applicable", "in_progress", "compliant", "non_compliant"]
                
              covered_entity:
                type: boolean
                description: Whether organization is a HIPAA covered entity
                
              business_associate:
                type: boolean
                description: Whether organization is a business associate
                
              safeguards:
                type: object
                properties:
                  administrative:
                    type: array
                    items:
                      type: object
                      properties:
                        control_name:
                          type: string
                        implemented:
                          type: boolean
                      additionalProperties: false
                      
                  physical:
                    type: array
                    items:
                      type: object
                      properties:
                        control_name:
                          type: string
                        status:
                          type: string
                          enum: ["not_implemented", "controlled", "implemented"]
                      additionalProperties: false
                      
                  technical:
                    type: array
                    items:
                      type: object
                      properties:
                        control_name:
                          type: string
                        implemented:
                          type: boolean
                      additionalProperties: false
                      
                additionalProperties: false
                
            additionalProperties: false
            
        additionalProperties:
          type: object
          description: Additional compliance frameworks
          
      security:
        type: object
        description: Security governance configuration
        properties:
          policies:
            type: array
            items:
              type: object
              required:
                - name
                - version
                - classification
              properties:
                name:
                  type: string
                  maxLength: 100
                  
                version:
                  type: string
                  pattern: '^[0-9]+\.[0-9]+$'
                  
                classification:
                  type: string
                  enum: ["public", "internal", "confidential", "restricted"]
                  
                review_cycle:
                  type: string
                  enum: ["monthly", "quarterly", "semi-annual", "annual"]
                  
                last_review:
                  type: string
                  format: date
                  
              additionalProperties: false
              
          controls:
            type: object
            properties:
              authentication:
                type: object
                properties:
                  multi_factor:
                    type: boolean
                  sso_provider:
                    type: string
                  session_timeout:
                    type: integer
                    minimum: 300
                  password_policy:
                    type: string
                    enum: ["basic", "complex", "passphrase"]
                additionalProperties: false
                
              authorization:
                type: object
                properties:
                  model:
                    type: string
                    enum: ["rbac", "abac", "rbac+abac"]
                  policy_engine:
                    type: string
                  zero_trust:
                    type: boolean
                  least_privilege:
                    type: boolean
                additionalProperties: false
                
              encryption:
                type: object
                properties:
                  at_rest:
                    type: object
                    properties:
                      algorithm:
                        type: string
                        enum: ["aes-256-gcm", "aes-256-cbc", "chacha20-poly1305"]
                      key_management:
                        type: string
                        enum: ["local", "aws-kms", "azure-key-vault", "vault"]
                    additionalProperties: false
                    
                  in_transit:
                    type: object
                    properties:
                      protocol:
                        type: string
                        enum: ["tls-1.2", "tls-1.3"]
                      certificate_management:
                        type: string
                        enum: ["manual", "aws-acm", "let-encrypt", "vault"]
                    additionalProperties: false
                    
                additionalProperties: false
                
              network_security:
                type: object
                properties:
                  firewall:
                    type: string
                    enum: ["aws-waf", "cloudflare", "fortinet", "palo-alto"]
                  ddos_protection:
                    type: string
                    enum: ["cloudflare", "aws-shield", "azure-ddos"]
                  ids_ips:
                    type: string
                    enum: ["suricata", "snort", "zeek"]
                additionalProperties: false
                
            additionalProperties: false
            
          vulnerability_management:
            type: object
            properties:
              scanning:
                type: object
                properties:
                  frequency:
                    type: string
                    enum: ["daily", "weekly", "monthly"]
                  tools:
                    type: array
                    items:
                      type: string
                      enum: ["owasp-zap", "nessus", "qualys", "rapid7", "burp-suite"]
                additionalProperties: false
                
              patch_management:
                type: object
                properties:
                  critical:
                    type: string
                    pattern: '^[0-9]+[smhd]$'
                  high:
                    type: string
                    pattern: '^[0-9]+[smhd]$'
                  medium:
                    type: string
                    pattern: '^[0-9]+[smhd]$'
                  low:
                    type: string
                    pattern: '^[0-9]+[smhd]$'
                additionalProperties: false
                
              penetration_testing:
                type: object
                properties:
                  frequency:
                    type: string
                    enum: ["quarterly", "semi-annually", "annually"]
                  provider:
                    type: string
                    enum: ["internal", "external"]
                  last_test:
                    type: string
                    format: date
                additionalProperties: false
                
            additionalProperties: false
            
        additionalProperties: false
        
      audit:
        type: object
        description: Audit configuration
        properties:
          configuration:
            type: object
            properties:
              enabled:
                type: boolean
                default: false
                
              level:
                type: string
                enum: ["basic", "standard", "comprehensive", "forensic"]
                default: "basic"
                
              retention_period:
                type: string
                pattern: '^[0-9]+[dmy]$'
                default: "90d"
                
              storage_location:
                type: string
                format: uri
                
              immutable_storage:
                type: boolean
                default: false
                
            additionalProperties: false
            
          events:
            type: object
            properties:
              system_events:
                type: array
                items:
                  type: string
                  enum: ["agent_deployment", "agent_modification", "agent_deletion", "configuration_change"]
                  
              access_events:
                type: array
                items:
                  type: string
                  enum: ["authentication_attempt", "authorization_decision", "privilege_escalation", "data_access"]
                  
              operational_events:
                type: array
                items:
                  type: string
                  enum: ["orchestration_start", "orchestration_complete", "error_occurrence", "performance_anomaly"]
                  
              compliance_events:
                type: array
                items:
                  type: string
                  enum: ["policy_violation", "threshold_exceeded", "certification_change", "audit_performed"]
                  
            additionalProperties: false
            
          trail_requirements:
            type: object
            properties:
              fields:
                type: array
                items:
                  type: string
                  enum: ["timestamp", "user_id", "session_id", "action", "resource", "result", "ip_address", "user_agent"]
                  
              integrity:
                type: object
                properties:
                  hashing:
                    type: string
                    enum: ["sha256", "sha512", "blake2b"]
                  signing:
                    type: string
                    enum: ["rsa-2048", "rsa-4096", "ecdsa-p256", "ecdsa-p384"]
                  chain_verification:
                    type: boolean
                additionalProperties: false
                
            additionalProperties: false
            
          reporting:
            type: object
            properties:
              automated_reports:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                    frequency:
                      type: string
                      enum: ["daily", "weekly", "monthly", "quarterly"]
                    recipients:
                      type: array
                      items:
                        type: string
                        format: email
                  additionalProperties: false
                  
            additionalProperties: false
            
        additionalProperties: false
        
      data_governance:
        type: object
        description: Data governance configuration
        properties:
          classification:
            type: object
            properties:
              levels:
                type: object
                additionalProperties:
                  type: object
                  properties:
                    description:
                      type: string
                      maxLength: 200
                    controls:
                      type: string
                      enum: ["standard", "enhanced", "strict", "maximum"]
                  additionalProperties: false
                  
            additionalProperties: false
            
          lifecycle:
            type: object
            properties:
              collection:
                type: object
                properties:
                  consent_required:
                    type: boolean
                  purpose_limitation:
                    type: boolean
                  data_minimization:
                    type: boolean
                additionalProperties: false
                
              processing:
                type: object
                properties:
                  lawful_basis_required:
                    type: boolean
                  transparency_required:
                    type: boolean
                  accuracy_maintained:
                    type: boolean
                additionalProperties: false
                
              retention:
                type: object
                properties:
                  default_period:
                    type: string
                    pattern: '^[0-9]+[dmy]$'
                  regulatory_requirements:
                    type: string
                  deletion_verification:
                    type: boolean
                additionalProperties: false
                
              disposal:
                type: object
                properties:
                  secure_deletion:
                    type: boolean
                  certification_required:
                    type: boolean
                  audit_trail:
                    type: boolean
                additionalProperties: false
                
            additionalProperties: false
            
          privacy:
            type: object
            properties:
              gdpr:
                type: object
                properties:
                  applicable:
                    type: boolean
                  data_protection_officer:
                    type: string
                    format: email
                  privacy_impact_assessments:
                    type: boolean
                additionalProperties: false
                
              ccpa:
                type: object
                properties:
                  applicable:
                    type: boolean
                  consumer_rights_enabled:
                    type: boolean
                  opt_out_mechanism:
                    type: boolean
                additionalProperties: false
                
              data_residency:
                type: object
                properties:
                  requirements:
                    type: boolean
                  allowed_regions:
                    type: array
                    items:
                      type: string
                  cross_border_transfers:
                    type: string
                    enum: ["allowed", "restricted", "prohibited"]
                additionalProperties: false
                
            additionalProperties: false
            
          quality:
            type: object
            properties:
              dimensions:
                type: array
                items:
                  type: object
                  properties:
                    dimension:
                      type: string
                      enum: ["accuracy", "completeness", "consistency", "timeliness", "validity", "uniqueness"]
                    target:
                      type: number
                      minimum: 0
                      maximum: 1
                  additionalProperties: false
                  
              monitoring:
                type: object
                properties:
                  automated_checks:
                    type: boolean
                  anomaly_detection:
                    type: boolean
                  quality_dashboards:
                    type: boolean
                additionalProperties: false
                
            additionalProperties: false
            
        additionalProperties: false
        
      risk_management:
        type: object
        description: Risk management framework
        properties:
          framework:
            type: object
            properties:
              methodology:
                type: string
                enum: ["iso31000", "coso", "nist", "fair"]
              risk_appetite:
                type: string
                enum: ["low", "moderate", "high"]
              review_cycle:
                type: string
                enum: ["monthly", "quarterly", "semi-annually", "annually"]
            additionalProperties: false
            
          categories:
            type: object
            additionalProperties:
              type: object
              properties:
                risks:
                  type: integer
                  minimum: 0
                high_risks:
                  type: integer
                  minimum: 0
                mitigation_rate:
                  type: number
                  minimum: 0
                  maximum: 1
              additionalProperties: false
              
          controls:
            type: object
            properties:
              preventive:
                type: object
                properties:
                  total:
                    type: integer
                    minimum: 0
                  effective:
                    type: integer
                    minimum: 0
                  effectiveness:
                    type: number
                    minimum: 0
                    maximum: 1
                additionalProperties: false
                
              detective:
                type: object
                properties:
                  total:
                    type: integer
                    minimum: 0
                  effective:
                    type: integer
                    minimum: 0
                  effectiveness:
                    type: number
                    minimum: 0
                    maximum: 1
                additionalProperties: false
                
              corrective:
                type: object
                properties:
                  total:
                    type: integer
                    minimum: 0
                  effective:
                    type: integer
                    minimum: 0
                  effectiveness:
                    type: number
                    minimum: 0
                    maximum: 1
                additionalProperties: false
                
            additionalProperties: false
            
          monitoring:
            type: object
            properties:
              kris:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                    threshold:
                      oneOf:
                        - type: number
                        - type: integer
                    current:
                      oneOf:
                        - type: number
                        - type: integer
                  additionalProperties: false
                description: Key Risk Indicators
                
            additionalProperties: false
            
        additionalProperties: false
        
      certification:
        type: object
        description: Certification and attestation configuration
        properties:
          active_certifications:
            type: array
            items:
              type: object
              properties:
                name:
                  type: string
                issuer:
                  type: string
                valid_until:
                  type: string
                  format: date
              additionalProperties: false
              
          attestations:
            type: array
            items:
              type: object
              properties:
                type:
                  type: string
                  enum: ["management_assertion", "third_party_audit", "self_assessment"]
                date:
                  type: string
                  format: date
                signatory:
                  type: string
                auditor:
                  type: string
              additionalProperties: false
              
          continuous_compliance:
            type: object
            properties:
              monitoring:
                type: boolean
              automated_checks:
                type: boolean
              deviation_alerts:
                type: boolean
              remediation_sla:
                type: string
                pattern: '^[0-9]+[smhd]$'
            additionalProperties: false
            
        additionalProperties: false
        
    additionalProperties: false
    
additionalProperties: false