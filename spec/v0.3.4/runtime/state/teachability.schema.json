{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://openstandardagents.org/schemas/v0.3.4/runtime/state/teachability.json",
  "title": "Agent Teachability",
  "description": "Configuration for agent learning capabilities, including teachable moments, feedback incorporation, and knowledge acquisition",
  "type": "object",
  "properties": {
    "teachability_config": {
      "$ref": "#/definitions/TeachabilityConfig"
    },
    "learning_history": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/LearningEvent"
      },
      "description": "History of learning events"
    }
  },
  "definitions": {
    "TeachabilityConfig": {
      "type": "object",
      "description": "Configuration for agent teachability",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Whether teachability is enabled"
        },
        "learning_modes": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "interactive",
              "observation",
              "feedback",
              "demonstration",
              "correction",
              "reinforcement"
            ]
          },
          "description": "Enabled learning modes"
        },
        "memory_persistence": {
          "type": "string",
          "enum": ["session", "persistent", "episodic"],
          "default": "persistent",
          "description": "How learned knowledge is persisted"
        },
        "max_memory_size": {
          "type": "integer",
          "minimum": 1,
          "description": "Maximum teachable memory size in items"
        },
        "confidence_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.7,
          "description": "Confidence threshold for applying learned knowledge"
        },
        "verification_required": {
          "type": "boolean",
          "default": true,
          "description": "Whether learned knowledge requires verification"
        },
        "learning_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.5,
          "description": "How quickly agent incorporates new knowledge"
        },
        "forgetting_enabled": {
          "type": "boolean",
          "default": true,
          "description": "Whether agent can forget unused knowledge"
        },
        "conflict_resolution": {
          "type": "string",
          "enum": ["latest", "highest_confidence", "most_used", "ask_user"],
          "default": "highest_confidence",
          "description": "How to resolve conflicting learned knowledge"
        }
      }
    },
    "LearningEvent": {
      "type": "object",
      "required": ["id", "type", "timestamp", "content"],
      "description": "Record of a learning event",
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Learning event identifier"
        },
        "type": {
          "type": "string",
          "enum": [
            "fact_learned",
            "procedure_learned",
            "preference_learned",
            "correction_received",
            "feedback_received",
            "demonstration_observed",
            "pattern_recognized"
          ],
          "description": "Type of learning event"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When learning occurred"
        },
        "content": {
          "$ref": "#/definitions/LearnedContent"
        },
        "source": {
          "type": "string",
          "description": "Source of learning (user ID, agent ID, etc.)"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in learned knowledge"
        },
        "verified": {
          "type": "boolean",
          "default": false,
          "description": "Whether knowledge has been verified"
        },
        "applied_count": {
          "type": "integer",
          "minimum": 0,
          "default": 0,
          "description": "Number of times applied"
        },
        "success_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Success rate when applied"
        },
        "context": {
          "type": "object",
          "description": "Context of learning event",
          "additionalProperties": true
        }
      }
    },
    "LearnedContent": {
      "type": "object",
      "description": "Content that was learned",
      "properties": {
        "category": {
          "type": "string",
          "enum": [
            "fact",
            "preference",
            "procedure",
            "constraint",
            "goal",
            "heuristic",
            "pattern"
          ],
          "description": "Category of learned content"
        },
        "fact": {
          "$ref": "#/definitions/LearnedFact"
        },
        "preference": {
          "$ref": "#/definitions/LearnedPreference"
        },
        "procedure": {
          "$ref": "#/definitions/LearnedProcedure"
        },
        "constraint": {
          "$ref": "#/definitions/LearnedConstraint"
        },
        "goal": {
          "$ref": "#/definitions/LearnedGoal"
        },
        "heuristic": {
          "$ref": "#/definitions/LearnedHeuristic"
        },
        "pattern": {
          "$ref": "#/definitions/LearnedPattern"
        }
      }
    },
    "LearnedFact": {
      "type": "object",
      "required": ["statement"],
      "properties": {
        "statement": {
          "type": "string",
          "description": "Factual statement learned"
        },
        "domain": {
          "type": "string",
          "description": "Domain or topic area"
        },
        "related_facts": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Related fact IDs"
        },
        "source_reliability": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Reliability of source"
        }
      }
    },
    "LearnedPreference": {
      "type": "object",
      "required": ["key", "value"],
      "properties": {
        "key": {
          "type": "string",
          "description": "Preference key"
        },
        "value": {
          "description": "Preference value",
          "oneOf": [
            {"type": "string"},
            {"type": "number"},
            {"type": "boolean"},
            {"type": "object"}
          ]
        },
        "scope": {
          "type": "string",
          "enum": ["global", "context_specific", "user_specific"],
          "description": "Preference scope"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "description": "Preference priority"
        }
      }
    },
    "LearnedProcedure": {
      "type": "object",
      "required": ["name", "steps"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Procedure name"
        },
        "description": {
          "type": "string",
          "description": "What procedure does"
        },
        "steps": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "order": {
                "type": "integer"
              },
              "action": {
                "type": "string"
              },
              "conditions": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "expected_outcome": {
                "type": "string"
              }
            }
          },
          "description": "Procedure steps"
        },
        "preconditions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Required preconditions"
        },
        "postconditions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Expected postconditions"
        }
      }
    },
    "LearnedConstraint": {
      "type": "object",
      "required": ["type", "rule"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["must", "must_not", "should", "should_not"],
          "description": "Constraint type"
        },
        "rule": {
          "type": "string",
          "description": "Constraint rule"
        },
        "context": {
          "type": "string",
          "description": "When constraint applies"
        },
        "exceptions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Known exceptions"
        }
      }
    },
    "LearnedGoal": {
      "type": "object",
      "required": ["description"],
      "properties": {
        "description": {
          "type": "string",
          "description": "Goal description"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "description": "Goal priority"
        },
        "success_criteria": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Success criteria"
        },
        "sub_goals": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Sub-goal IDs"
        }
      }
    },
    "LearnedHeuristic": {
      "type": "object",
      "required": ["rule", "confidence"],
      "properties": {
        "rule": {
          "type": "string",
          "description": "Heuristic rule"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in heuristic"
        },
        "applicability": {
          "type": "string",
          "description": "When to apply heuristic"
        },
        "exceptions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Known exceptions"
        },
        "success_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Times heuristic succeeded"
        },
        "failure_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Times heuristic failed"
        }
      }
    },
    "LearnedPattern": {
      "type": "object",
      "required": ["signature", "occurrences"],
      "properties": {
        "signature": {
          "type": "string",
          "description": "Pattern signature"
        },
        "occurrences": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of occurrences"
        },
        "contexts": {
          "type": "array",
          "items": {
            "type": "object"
          },
          "description": "Contexts where pattern appeared"
        },
        "predictive_power": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "How well pattern predicts outcomes"
        }
      }
    }
  }
}
