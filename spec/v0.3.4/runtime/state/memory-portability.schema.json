{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://openstandardagents.org/schemas/v0.3.4/runtime/state/memory-portability.json",
  "title": "Memory Portability",
  "description": "Standard format for transferring agent memory and learned knowledge between runtimes and frameworks",
  "type": "object",
  "required": ["version", "agent_id", "memory_snapshot"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Memory format version"
    },
    "agent_id": {
      "type": "string",
      "format": "uri",
      "pattern": "^agent://[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
      "description": "Agent identifier"
    },
    "snapshot_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique snapshot identifier"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Snapshot creation timestamp"
    },
    "memory_snapshot": {
      "$ref": "#/definitions/MemorySnapshot"
    },
    "export_metadata": {
      "$ref": "#/definitions/ExportMetadata"
    }
  },
  "definitions": {
    "MemorySnapshot": {
      "type": "object",
      "description": "Complete memory snapshot",
      "properties": {
        "working_memory": {
          "$ref": "#/definitions/WorkingMemory"
        },
        "long_term_memory": {
          "$ref": "#/definitions/LongTermMemory"
        },
        "episodic_memory": {
          "$ref": "#/definitions/EpisodicMemory"
        },
        "semantic_memory": {
          "$ref": "#/definitions/SemanticMemory"
        },
        "procedural_memory": {
          "$ref": "#/definitions/ProceduralMemory"
        },
        "vector_store": {
          "$ref": "#/definitions/VectorStore"
        }
      }
    },
    "WorkingMemory": {
      "type": "object",
      "description": "Short-term working memory (recent context)",
      "properties": {
        "capacity": {
          "type": "integer",
          "minimum": 1,
          "description": "Maximum items in working memory"
        },
        "items": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/MemoryEntry"
          },
          "description": "Current working memory items"
        },
        "attention_focus": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Current attention focus (item IDs)"
        }
      }
    },
    "LongTermMemory": {
      "type": "object",
      "description": "Persistent long-term memory",
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/MemoryEntry"
          },
          "description": "Long-term memory entries"
        },
        "consolidation_rules": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ConsolidationRule"
          },
          "description": "Rules for consolidating working memory to long-term"
        },
        "forgetting_curve": {
          "$ref": "#/definitions/ForgettingCurve"
        }
      }
    },
    "EpisodicMemory": {
      "type": "object",
      "description": "Memory of past experiences and episodes",
      "properties": {
        "episodes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Episode"
          },
          "description": "Stored episodes"
        },
        "temporal_links": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/TemporalLink"
          },
          "description": "Temporal relationships between episodes"
        }
      }
    },
    "SemanticMemory": {
      "type": "object",
      "description": "Factual knowledge and concepts",
      "properties": {
        "facts": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Fact"
          },
          "description": "Stored facts"
        },
        "concepts": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Concept"
          },
          "description": "Learned concepts"
        },
        "relationships": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Relationship"
          },
          "description": "Relationships between concepts"
        },
        "knowledge_graph": {
          "$ref": "#/definitions/KnowledgeGraph"
        }
      }
    },
    "ProceduralMemory": {
      "type": "object",
      "description": "How-to knowledge and procedures",
      "properties": {
        "procedures": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Procedure"
          },
          "description": "Learned procedures"
        },
        "skills": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Skill"
          },
          "description": "Acquired skills"
        },
        "patterns": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Pattern"
          },
          "description": "Recognized patterns"
        }
      }
    },
    "VectorStore": {
      "type": "object",
      "description": "Vector embeddings for semantic search",
      "properties": {
        "dimension": {
          "type": "integer",
          "minimum": 1,
          "description": "Embedding dimension"
        },
        "model": {
          "type": "string",
          "description": "Embedding model used"
        },
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/VectorEntry"
          },
          "description": "Vector entries"
        },
        "index_type": {
          "type": "string",
          "enum": ["flat", "hnsw", "ivf", "annoy"],
          "description": "Vector index type"
        }
      }
    },
    "MemoryEntry": {
      "type": "object",
      "required": ["id", "content", "timestamp"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Entry identifier"
        },
        "content": {
          "type": "string",
          "description": "Memory content"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Creation timestamp"
        },
        "importance": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Importance score (0-1)"
        },
        "access_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Access frequency"
        },
        "last_accessed": {
          "type": "string",
          "format": "date-time",
          "description": "Last access time"
        },
        "decay_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Memory decay rate"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Memory tags"
        },
        "metadata": {
          "type": "object",
          "additionalProperties": true
        }
      }
    },
    "Episode": {
      "type": "object",
      "required": ["id", "timestamp", "events"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Episode identifier"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Episode timestamp"
        },
        "events": {
          "type": "array",
          "items": {
            "type": "object"
          },
          "description": "Events in episode"
        },
        "context": {
          "type": "object",
          "description": "Episode context",
          "additionalProperties": true
        },
        "outcome": {
          "type": "string",
          "description": "Episode outcome"
        },
        "lessons_learned": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Lessons from episode"
        }
      }
    },
    "Fact": {
      "type": "object",
      "required": ["id", "statement"],
      "properties": {
        "id": {
          "type": "string"
        },
        "statement": {
          "type": "string",
          "description": "Factual statement"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in fact"
        },
        "source": {
          "type": "string",
          "description": "Fact source"
        },
        "verified": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "Concept": {
      "type": "object",
      "required": ["id", "name"],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "definition": {
          "type": "string"
        },
        "attributes": {
          "type": "object",
          "additionalProperties": true
        },
        "examples": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "Relationship": {
      "type": "object",
      "required": ["subject", "predicate", "object"],
      "properties": {
        "subject": {
          "type": "string",
          "description": "Subject concept ID"
        },
        "predicate": {
          "type": "string",
          "description": "Relationship type"
        },
        "object": {
          "type": "string",
          "description": "Object concept ID"
        },
        "strength": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Relationship strength"
        }
      }
    },
    "Procedure": {
      "type": "object",
      "required": ["id", "name", "steps"],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "steps": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "order": {
                "type": "integer"
              },
              "action": {
                "type": "string"
              },
              "conditions": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        },
        "success_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "Skill": {
      "type": "object",
      "required": ["id", "name"],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "proficiency": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Skill proficiency level"
        },
        "practice_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of times practiced"
        },
        "related_procedures": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "Pattern": {
      "type": "object",
      "required": ["id", "signature"],
      "properties": {
        "id": {
          "type": "string"
        },
        "signature": {
          "type": "string",
          "description": "Pattern signature"
        },
        "occurrences": {
          "type": "integer",
          "minimum": 0
        },
        "contexts": {
          "type": "array",
          "items": {
            "type": "object"
          }
        }
      }
    },
    "VectorEntry": {
      "type": "object",
      "required": ["id", "embedding", "content"],
      "properties": {
        "id": {
          "type": "string"
        },
        "embedding": {
          "type": "array",
          "items": {
            "type": "number"
          }
        },
        "content": {
          "type": "string"
        },
        "metadata": {
          "type": "object",
          "additionalProperties": true
        }
      }
    },
    "ConsolidationRule": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["frequency", "importance", "recency", "rehearsal"]
        },
        "threshold": {
          "type": "number"
        }
      }
    },
    "ForgettingCurve": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "decay_function": {
          "type": "string",
          "enum": ["exponential", "power_law", "logarithmic"]
        },
        "half_life_hours": {
          "type": "number",
          "minimum": 0
        }
      }
    },
    "TemporalLink": {
      "type": "object",
      "properties": {
        "from_episode": {
          "type": "string"
        },
        "to_episode": {
          "type": "string"
        },
        "relationship": {
          "type": "string",
          "enum": ["before", "after", "during", "causes", "enables"]
        }
      }
    },
    "KnowledgeGraph": {
      "type": "object",
      "properties": {
        "nodes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "type": {
                "type": "string"
              },
              "properties": {
                "type": "object"
              }
            }
          }
        },
        "edges": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "from": {
                "type": "string"
              },
              "to": {
                "type": "string"
              },
              "type": {
                "type": "string"
              },
              "weight": {
                "type": "number"
              }
            }
          }
        }
      }
    },
    "ExportMetadata": {
      "type": "object",
      "properties": {
        "source_runtime": {
          "type": "string",
          "description": "Runtime that exported memory"
        },
        "source_version": {
          "type": "string",
          "description": "Source runtime version"
        },
        "target_runtime": {
          "type": "string",
          "description": "Intended target runtime (if known)"
        },
        "format": {
          "type": "string",
          "enum": ["json", "msgpack", "protobuf"],
          "default": "json"
        },
        "compression": {
          "type": "string",
          "enum": ["none", "gzip", "brotli"],
          "default": "none"
        },
        "encrypted": {
          "type": "boolean",
          "default": false
        },
        "size_bytes": {
          "type": "integer",
          "minimum": 0
        },
        "checksum": {
          "type": "string"
        }
      }
    }
  }
}
