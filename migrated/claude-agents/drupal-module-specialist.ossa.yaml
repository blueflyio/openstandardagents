# Migrated from ~/.claude/agents/drupal-module-specialist.yml
# OSSA v0.3.0 Compliant - Runtime-configurable LLM
apiVersion: ossa/v0.3.0
kind: Agent

metadata:
  name: drupal-module-specialist
  version: 1.0.0
  description: Drupal 11 custom module development and PHPCS compliance specialist
  labels:
    domain: drupal
    tier: development
    runtime: claude-code
    category: scaffolding
  annotations:
    ossa.io/migrated-from: claude-code-agent
    ossa.io/migration-date: "2025-12-09"

spec:
  role: |
    # drupal-module-specialist

    Develop Drupal 11 custom modules in /Users/flux423/Sites/LLM/all_drupal_custom/modules/.
    Follow Drupal coding standards, use PHPCS, ensure OSSA compliance.
    NEVER edit Composer-managed paths (web/modules, web/themes, web/core).

    ## Responsibilities
    - Create new Drupal modules with proper structure
    - Implement hooks, services, plugins, and forms
    - Ensure PHPCS compliance (Drupal coding standards)
    - Write PHPUnit and Kernel tests
    - Generate module documentation

    ## Protected Paths (NEVER EDIT)
    - /Users/flux423/Sites/LLM/llm-platform/web/modules/
    - /Users/flux423/Sites/LLM/llm-platform/web/themes/
    - /Users/flux423/Sites/LLM/llm-platform/web/core/

    ## Source Paths (EDIT THESE)
    - /Users/flux423/Sites/LLM/all_drupal_custom/modules/
    - /Users/flux423/Sites/LLM/all_drupal_custom/themes/
    - /Users/flux423/Sites/LLM/all_drupal_custom/recipes/

  llm:
    provider: anthropic
    model: claude-sonnet-4-20250514
    temperature: 0.3
    maxTokens: 16000

  tools:
    - type: mcp
      name: filesystem
      capabilities:
        - name: read_file
          description: Read file contents
        - name: write_file
          description: Write file contents
        - name: edit_file
          description: Edit file contents
        - name: glob
          description: Search for files by pattern
        - name: grep
          description: Search file contents
    - type: function
      name: bash
      capabilities:
        - name: git
          description: Git operations (status, diff, commit, push)
        - name: phpcs
          description: PHP CodeSniffer for Drupal standards
        - name: phpcbf
          description: PHP Code Beautifier and Fixer
        - name: drush
          description: Drupal CLI commands
        - name: composer
          description: PHP dependency management

  autonomy:
    level: supervised
    approval_required: true
    allowed_actions:
      - read_file
      - edit_file
      - write_file
      - glob
      - grep
      - git_status
      - git_diff
      - phpcs
      - phpcbf
    blocked_actions:
      - delete_file
      - rm_rf
      - git_push_force
      - composer_require

  constraints:
    cost:
      maxTokensPerRequest: 16000
      maxTokensPerDay: 500000
    performance:
      timeoutSeconds: 300
      maxConcurrentRequests: 3

  state:
    mode: session
    storage:
      type: memory
      retention: "4h"

  observability:
    tracing:
      enabled: true
      exporter: otlp
    metrics:
      enabled: true
      exporter: prometheus
    logging:
      level: info
      format: json

  safety:
    content_filtering:
      enabled: true
      categories:
        - secrets
        - credentials
    guardrails:
      enabled: true
      max_tool_calls: 100

extensions:
  mcp:
    enabled: true
    server_type: stdio
    server_name: drupal-mcp
    tools:
      - name: phpcs_check
        description: Run PHP CodeSniffer on specified path
        input_schema:
          type: object
          properties:
            path:
              type: string
              description: Path to check
          required:
            - path
      - name: drush_command
        description: Execute Drush command
        input_schema:
          type: object
          properties:
            command:
              type: string
              description: Drush command to execute
          required:
            - command
