---
# ============================================================================
# Kubernetes Secret for {{projectName}}
# IMPORTANT: This is a TEMPLATE. Never commit actual secrets to version control.
# Use external secret management (e.g., Sealed Secrets, External Secrets Operator)
# or inject secrets at deploy time via CI/CD pipelines.
# ============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: {{secretName}}
  namespace: {{namespace}}
  labels:
    app: {{appName}}
    component: {{component}}
    managed-by: kubernetes
    part-of: {{projectName}}
  annotations:
    description: "Secrets for {{projectDescription}}"
type: Opaque
data:
  # ==========================================================================
  # IMPORTANT: All values must be base64 encoded
  # Example: echo -n "your-secret-value" | base64
  # ==========================================================================

  {{#if databaseSecrets}}
  # Database Credentials
  DATABASE_USER: {{base64 dbUser}}
  DATABASE_PASSWORD: {{base64 dbPassword}}
  {{#if dbConnectionString}}
  DATABASE_URL: {{base64 dbConnectionString}}
  {{/if}}
  {{/if}}

  {{#if redisSecrets}}
  # Redis Credentials
  REDIS_PASSWORD: {{base64 redisPassword}}
  {{#if redisConnectionString}}
  REDIS_URL: {{base64 redisConnectionString}}
  {{/if}}
  {{/if}}

  {{#if apiKeys}}
  # API Keys and Tokens
  {{#each apiKeys}}
  {{@key}}: {{base64 this}}
  {{/each}}
  {{/if}}

  {{#if jwtSecrets}}
  # JWT Configuration
  JWT_SECRET: {{base64 jwtSecret}}
  {{#if jwtPrivateKey}}
  JWT_PRIVATE_KEY: {{base64 jwtPrivateKey}}
  {{/if}}
  {{#if jwtPublicKey}}
  JWT_PUBLIC_KEY: {{base64 jwtPublicKey}}
  {{/if}}
  {{/if}}

  {{#if encryptionKeys}}
  # Encryption Keys
  {{#each encryptionKeys}}
  {{@key}}: {{base64 this}}
  {{/each}}
  {{/if}}

  {{#if oauth}}
  # OAuth Credentials
  OAUTH_CLIENT_ID: {{base64 oauthClientId}}
  OAUTH_CLIENT_SECRET: {{base64 oauthClientSecret}}
  {{/if}}

  {{#if smtpSecrets}}
  # SMTP Configuration
  SMTP_USER: {{base64 smtpUser}}
  SMTP_PASSWORD: {{base64 smtpPassword}}
  {{/if}}

  {{#if awsSecrets}}
  # AWS Credentials
  AWS_ACCESS_KEY_ID: {{base64 awsAccessKeyId}}
  AWS_SECRET_ACCESS_KEY: {{base64 awsSecretAccessKey}}
  {{/if}}

  {{#if customSecrets}}
  # Custom Secrets
  {{#each customSecrets}}
  {{@key}}: {{base64 this}}
  {{/each}}
  {{/if}}

---
# ============================================================================
# Docker Registry Secret (for private container registries)
# ============================================================================
{{#if dockerRegistry}}
apiVersion: v1
kind: Secret
metadata:
  name: {{dockerRegistrySecretName}}
  namespace: {{namespace}}
  labels:
    app: {{appName}}
    component: {{component}}
    managed-by: kubernetes
    part-of: {{projectName}}
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{dockerConfigJson}}
{{/if}}

---
# ============================================================================
# TLS Certificate Secret (if not using cert-manager)
# ============================================================================
{{#if tlsCertificate}}
apiVersion: v1
kind: Secret
metadata:
  name: {{tlsSecretName}}
  namespace: {{namespace}}
  labels:
    app: {{appName}}
    component: {{component}}
    managed-by: kubernetes
    part-of: {{projectName}}
type: kubernetes.io/tls
data:
  tls.crt: {{base64 tlsCert}}
  tls.key: {{base64 tlsKey}}
  {{#if caCert}}
  ca.crt: {{base64 caCert}}
  {{/if}}
{{/if}}

---
# ============================================================================
# RECOMMENDED: Use Sealed Secrets or External Secrets Operator
# ============================================================================
# Example with Sealed Secrets:
# ---
# apiVersion: bitnami.com/v1alpha1
# kind: SealedSecret
# metadata:
#   name: {{secretName}}
#   namespace: {{namespace}}
# spec:
#   encryptedData:
#     DATABASE_PASSWORD: AgA...encrypted...
#
# Example with External Secrets Operator:
# ---
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: {{secretName}}
#   namespace: {{namespace}}
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     name: vault-backend
#     kind: SecretStore
#   target:
#     name: {{secretName}}
#     creationPolicy: Owner
#   data:
#     - secretKey: DATABASE_PASSWORD
#       remoteRef:
#         key: database/credentials
#         property: password
