# FedRAMP Controls Mapping for OSSA v0.1.8
apiVersion: ossa.ai/v0.1.8
kind: ComplianceMapping
metadata:
  name: fedramp-mapping
  framework: FedRAMP
  version: "2.0"
  authority: GSA
  classification: Moderate
  description: "FedRAMP control mappings for OSSA-compliant agent systems"

# Access Control Family (AC)
controls:
  AC-1: # Access Control Policy and Procedures
    implemented: true
    control_summary: "Organization develops, documents, and disseminates access control policy"
    ossa_components:
      - workspace.security.authentication
      - workspace.security.authorization
      - agent.metadata.security
    implementation:
      - "Role-based access control (RBAC) implemented in workspace configuration"
      - "Authentication policies enforced through OAuth 2.0"
      - "Access control documentation in workspace.security.policies"
    evidence:
      - path: ".agents-workspace/config/security.yaml"
      - path: "v0.1.8/schemas/workspace.schema.json"

  AC-2: # Account Management
    implemented: true
    control_summary: "Organization manages information system accounts"
    ossa_components:
      - workspace.security.authentication.users
      - agent.runtime.serviceAccount
    implementation:
      - "User accounts managed through workspace authentication provider"
      - "Service accounts automatically provisioned for agents"
      - "Account lifecycle managed through OSSA CLI commands"

  AC-3: # Access Enforcement
    implemented: true
    control_summary: "System enforces approved authorizations for logical access"
    ossa_components:
      - workspace.security.authorization.rbac
      - agent.capabilities.permissions
    implementation:
      - "RBAC policies enforce capability access"
      - "Agent permissions validated before execution"
      - "API gateway enforces endpoint authorization"

  AC-6: # Least Privilege
    implemented: true
    control_summary: "Organization employs principle of least privilege"
    ossa_components:
      - agent.resources.limits
      - workspace.security.authorization.defaultRole
    implementation:
      - "Agents run with minimal required privileges"
      - "Resource limits enforce constraint boundaries"
      - "Default deny authorization model"

# Audit and Accountability Family (AU)
  AU-2: # Audit Events
    implemented: true
    control_summary: "Organization determines auditable events"
    ossa_components:
      - workspace.observability.logging
      - agent.metadata.audit
    implementation:
      - "All agent lifecycle events logged"
      - "API access events captured"
      - "Configuration changes audited"

  AU-3: # Content of Audit Records
    implemented: true
    control_summary: "System generates audit records with required content"
    ossa_components:
      - workspace.observability.logging.format
      - agent.metrics.auditLog
    implementation:
      - "Structured JSON logging with required fields"
      - "Timestamps, user identity, event type captured"
      - "Audit records include outcome and additional details"

  AU-6: # Audit Review, Analysis, and Reporting
    implemented: true
    control_summary: "Organization reviews and analyzes system audit records"
    ossa_components:
      - workspace.observability.metrics
      - workspace.security.compliance.auditReporting
    implementation:
      - "Automated audit analysis through metrics collection"
      - "Compliance reports generated on schedule"
      - "Anomaly detection for security events"

# Configuration Management Family (CM)
  CM-2: # Baseline Configuration
    implemented: true
    control_summary: "Organization develops, documents and maintains baseline configuration"
    ossa_components:
      - agent.metadata.version
      - workspace.configuration
    implementation:
      - "Agent manifests define baseline configurations"
      - "Workspace configurations version controlled"
      - "Configuration drift detection implemented"

  CM-6: # Configuration Settings
    implemented: true
    control_summary: "Organization establishes mandatory configuration settings"
    ossa_components:
      - workspace.configuration.security
      - agent.runtime.securityContext
    implementation:
      - "Security configuration settings enforced"
      - "Agent runtime security contexts mandatory"
      - "Configuration validation before deployment"

# Identification and Authentication Family (IA)
  IA-2: # Identification and Authentication
    implemented: true
    control_summary: "System uniquely identifies and authenticates organizational users"
    ossa_components:
      - workspace.security.authentication
      - agent.identity
    implementation:
      - "Multi-factor authentication supported"
      - "Unique agent identities maintained"
      - "API key authentication for service accounts"

  IA-5: # Authenticator Management
    implemented: true
    control_summary: "Organization manages system authenticators"
    ossa_components:
      - workspace.security.authentication.keyRotation
      - agent.credentials.management
    implementation:
      - "Automatic key rotation for service accounts"
      - "Secure credential storage with encryption"
      - "Authenticator lifecycle management"

# System and Communications Protection Family (SC)
  SC-7: # Boundary Protection
    implemented: true
    control_summary: "System monitors and controls communications at external boundaries"
    ossa_components:
      - workspace.networking.ingress
      - workspace.networking.egress
    implementation:
      - "Network ingress/egress controls configured"
      - "TLS encryption for all external communications"
      - "Firewall rules enforced at workspace boundaries"

  SC-8: # Transmission Confidentiality and Integrity
    implemented: true
    control_summary: "System protects confidentiality and integrity of transmitted information"
    ossa_components:
      - workspace.networking.tls
      - agent.communication.encryption
    implementation:
      - "TLS 1.3 required for all communications"
      - "End-to-end encryption for agent communications"
      - "Certificate management automated"

  SC-12: # Cryptographic Key Establishment and Management
    implemented: true
    control_summary: "Organization establishes and manages cryptographic keys"
    ossa_components:
      - workspace.storage.encryption
      - agent.credentials.encryption
    implementation:
      - "Automated key generation and distribution"
      - "Key rotation policies enforced"
      - "Secure key storage with hardware security modules"

  SC-13: # Cryptographic Protection
    implemented: true
    control_summary: "System implements required cryptographic protections"
    ossa_components:
      - workspace.storage.encryption.algorithm
      - agent.data.encryption
    implementation:
      - "AES-256-GCM encryption for data at rest"
      - "FIPS 140-2 Level 3 compliant algorithms"
      - "Cryptographic integrity protection"

# System and Information Integrity Family (SI)
  SI-2: # Flaw Remediation
    implemented: true
    control_summary: "Organization identifies, reports, and corrects system flaws"
    ossa_components:
      - agent.metadata.version
      - workspace.updatePolicy
    implementation:
      - "Automated vulnerability scanning"
      - "Version management for security patches"
      - "Controlled update deployment process"

  SI-4: # Information System Monitoring
    implemented: true
    control_summary: "Organization monitors system to detect attacks and indicators of potential attacks"
    ossa_components:
      - workspace.observability.monitoring
      - agent.health.monitoring
    implementation:
      - "Real-time security event monitoring"
      - "Anomaly detection for agent behavior"
      - "Automated incident response triggers"

# Implementation Status
implementation_status:
  total_controls: 16
  implemented: 16
  partially_implemented: 0
  planned: 0
  not_applicable: 0
  overall_compliance: 100%

# Continuous Monitoring
continuous_monitoring:
  enabled: true
  assessment_frequency: "monthly"
  metrics_collection: true
  automated_reporting: true
  remediation_tracking: true

# Risk Assessment
risk_assessment:
  last_conducted: "2024-12-01"
  risk_level: "Low"
  identified_risks: []
  mitigation_strategies:
    - "Implement additional monitoring for privilege escalation"
    - "Enhance audit log retention and analysis"
    - "Regular security training for administrators"