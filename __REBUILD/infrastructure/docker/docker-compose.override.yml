version: '3.8'

services:
  gateway:
    build:
      context: /Users/flux423/Sites/LLM/OSSA
      dockerfile: infrastructure/docker/Dockerfile.gateway
    # remove any dependencies from base compose
    depends_on: {}
    environment:
      - NODE_ENV=development
      - REDIS_URL=redis://host.docker.internal:6382
      - SERVICE_PORT=3000
    command: ["npm", "run", "serve"]
    ports:
      - "4000:3000"  # Expose gateway on 4000 externally (maps to container 3000)

  discovery:
    profiles: ["disabled"]
    build:
      context: /Users/flux423/Sites/LLM/OSSA
      dockerfile: infrastructure/docker/Dockerfile.gateway
    deploy:
      replicas: 0
  coordination:
    profiles: ["disabled"]
    build:
      context: /Users/flux423/Sites/LLM/OSSA
      dockerfile: infrastructure/docker/Dockerfile.gateway
    deploy:
      replicas: 0
  orchestration:
    profiles: ["disabled"]
    build:
      context: /Users/flux423/Sites/LLM/OSSA
      dockerfile: infrastructure/docker/Dockerfile.gateway
    deploy:
      replicas: 0
  monitoring:
    profiles: ["disabled"]
    build:
      context: /Users/flux423/Sites/LLM/OSSA
      dockerfile: infrastructure/docker/Dockerfile.gateway
    deploy:
      replicas: 0
  redis:
    profiles: ["disabled"]
    deploy:
      replicas: 0
  postgres:
    profiles: ["disabled"]
    deploy:
      replicas: 0
