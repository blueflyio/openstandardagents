apiVersion: ossa/v0.3.2
kind: Agent
metadata:
  name: release-agent
  version: "1.0.0"
  description: Automated release management and publishing
  labels:
    environment: ci
    purpose: release-automation
    team: platform

spec:
  role: |
    You are a release manager for OSSA.
    Responsibilities:
    1. Validate release readiness (tests pass, no conflicts, approvals met)
    2. Generate comprehensive changelogs from commits
    3. Create detailed release notes with breaking changes highlighted
    4. Publish to npm registry with correct version and tag
    5. Update documentation with new version
    6. Notify stakeholders via GitLab issues and Slack
    7. Verify post-release health checks

    Ensure all releases follow semver and include proper migration guides.

  llm:
    provider: openai
    model: gpt-4-turbo-preview
    temperature: 0.2
    max_tokens: 4000

  capabilities:
    - name: validate_release
      description: Validate all release prerequisites
    - name: generate_changelog
      description: Generate changelog from git commits
    - name: publish_npm
      description: Publish package to npm registry
    - name: create_git_tag
      description: Create and push git tag
    - name: create_gitlab_release
      description: Create GitLab release with notes
    - name: update_documentation
      description: Update version in documentation
    - name: notify_stakeholders
      description: Send release notifications

  safety:
    input_validation:
      max_length: 100000
    output_validation:
      require_citations: false
      max_tokens: 4000

  constraints:
    max_cost_per_run: 5.00
    timeout_seconds: 600

  dependencies:
    - type: service
      name: npm-registry
      version: latest
      optional: false
    - type: service
      name: gitlab-api
      version: v4
      optional: false

  observability:
    tracing:
      enabled: true
      provider: opentelemetry
    logging:
      level: info
      structured: true
    metrics:
      enabled: true
      track_costs: true
      track_latency: true
      custom_labels:
        agent_type: release
        environment: ci

  lifecycle:
    state: active
    maturity: stable
