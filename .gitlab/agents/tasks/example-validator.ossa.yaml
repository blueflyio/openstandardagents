apiVersion: ossa/v0.3.0
kind: Agent
metadata:
  name: example-validator
  version: "1.0.0"
  description: Validates all example manifests against current schema
  labels:
    environment: ci
    purpose: release-automation
    team: platform

spec:
  role: |
    You are an example validator for OSSA manifests.

    Responsibilities:
    1. Test ALL example files in examples/ directory
    2. Validate YAML/JSON syntax correctness
    3. Check apiVersion matches current release version
    4. Ensure all required fields are present per schema
    5. Validate field types and constraints
    6. Check for deprecated fields or syntax
    7. Test that examples can be loaded by OSSA CLI
    8. Report validation errors with clear fixes
    9. FAIL CI pipeline if any example is invalid

    Validation Rules:
    - apiVersion must match current release (e.g., ossa/v0.3.0)
    - kind must be valid (Agent, Task, Workflow)
    - metadata.name must be kebab-case
    - metadata.version must be semantic version
    - spec.role must be non-empty string
    - spec.llm must have provider and model
    - All references (tools, capabilities) must be defined
    - No schema-invalid fields present

    Output Format:
    ```
    ✅ examples/getting-started/hello-world.ossa.yaml
    ❌ examples/advanced/broken-agent.ossa.yaml
       Line 15: apiVersion 'ossa/v0.2.9' should be 'ossa/v0.3.0'
       Line 42: Unknown field 'deprecatedField' in spec.llm

    Summary: 23/25 examples valid (92%)
    ```

    Exit Code:
    - 0 if all examples valid
    - 1 if any example invalid (BLOCKS RELEASE)

  llm:
    provider: anthropic
    model: claude-3-5-sonnet-20241022
    temperature: 0.1
    max_tokens: 4000

  capabilities:
    - name: find_examples
      description: Find all .ossa.yaml and .ossa.json files
    - name: validate_yaml
      description: Validate YAML syntax
    - name: validate_schema
      description: Validate against OSSA schema
    - name: run_ossa_cli
      description: Execute ossa validate command
    - name: report_errors
      description: Report validation errors

  safety:
    input_validation:
      max_length: 50000
    output_validation:
      require_citations: true
      max_tokens: 4000

  constraints:
    max_cost_per_run: 1.00
    timeout_seconds: 300

  dependencies:
    - type: cli
      name: ossa
      version: latest
      optional: false
    - type: service
      name: gitlab-api
      version: v4
      optional: true

  observability:
    tracing:
      enabled: true
      provider: opentelemetry
    logging:
      level: info
      structured: true
    metrics:
      enabled: true
      track_costs: true
      track_latency: true
      custom_labels:
        agent_type: example-validator
        environment: ci

  lifecycle:
    state: active
    maturity: stable
