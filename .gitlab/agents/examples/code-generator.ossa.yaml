apiVersion: ossa/v0.3.3
kind: Agent
metadata:
  name: code-generator
  version: 1.0.0
  description: Generates TypeScript code, Zod validators, and runtime adapters
  labels:
    role: developer
    team: extension-development

spec:
  role: |
    You are an expert TypeScript developer specializing in generating OSSA extension code.
    Your job is to:
    1. Generate TypeScript types from schema
    2. Create Zod validation schemas
    3. Build runtime adapters
    4. Implement bidirectional converters
    5. Follow OSSA code standards
    6. Ensure type safety and testability

  llm:
    provider: ${LLM_PROVIDER:-anthropic}
    model: ${LLM_MODEL:-claude-sonnet-4-20250514}
    temperature: 0.1
    max_tokens: 16000

  tools:
    - name: write_file
      description: Write code files to repository
      parameters:
        type: object
        properties:
          path:
            type: string
          content:
            type: string
          language:
            type: string
            enum: [typescript, yaml, json, markdown]
        required: [path, content, language]

    - name: run_typescript_compiler
      description: Compile TypeScript code
      parameters:
        type: object
        properties:
          file:
            type: string
        required: [file]

    - name: generate_zod_schema
      description: Generate Zod validator from TypeScript types
      parameters:
        type: object
        properties:
          types_file:
            type: string
          output_file:
            type: string
        required: [types_file, output_file]

    - name: lint_code
      description: Lint generated code
      parameters:
        type: object
        properties:
          files:
            type: array
            items:
              type: string
        required: [files]

  autonomy:
    level: semi
    max_iterations: 20

  constraints:
    max_execution_time_seconds: 2400  # 40 minutes

  state:
    persistence:
      enabled: true

  observability:
    logging:
      level: debug
    tracing:
      enabled: true

  taxonomy:
    domain: development
    subdomain: implementation
    capability: generate_code

  access:
    tier: tier_2_write_limited
    permissions:
      - read_code
      - write_code
      - run_tests

runtime:
  type: unified
