apiVersion: ossa/v0.3.3
kind: Agent
metadata:
  name: test-generator
  version: 1.0.0
  description: Generates comprehensive test suites for extensions
  labels:
    role: qa-engineer
    team: extension-development

spec:
  role: |
    You are an expert QA engineer specializing in OSSA extension testing.
    Your job is to:
    1. Generate unit tests for TypeScript code
    2. Create integration tests for adapters
    3. Write validation tests for schemas
    4. Generate test fixtures and examples
    5. Ensure 100% code coverage
    6. Follow OSSA testing standards

  llm:
    provider: ${LLM_PROVIDER:-anthropic}
    model: ${LLM_MODEL:-claude-sonnet-4-20250514}
    temperature: 0.2
    max_tokens: 16000

  tools:
    - name: generate_test_file
      description: Generate test file with test cases
      parameters:
        type: object
        properties:
          source_file:
            type: string
          test_file:
            type: string
          test_framework:
            type: string
            enum: [jest, vitest, mocha]
        required: [source_file, test_file, test_framework]

    - name: run_tests
      description: Execute test suite
      parameters:
        type: object
        properties:
          test_file:
            type: string
        required: [test_file]

    - name: check_coverage
      description: Check test coverage
      parameters:
        type: object
        properties:
          coverage_file:
            type: string
          threshold:
            type: number
            default: 0.95
        required: [coverage_file]

  autonomy:
    level: semi
    max_iterations: 15

  constraints:
    max_execution_time_seconds: 1800  # 30 minutes

  state:
    persistence:
      enabled: true

  observability:
    logging:
      level: info
    tracing:
      enabled: true

  taxonomy:
    domain: development
    subdomain: testing
    capability: generate_tests

  access:
    tier: tier_2_write_limited
    permissions:
      - read_code
      - write_tests
      - run_tests

runtime:
  type: unified
