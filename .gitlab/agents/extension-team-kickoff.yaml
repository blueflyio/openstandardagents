apiVersion: ossa/v0.3.3
kind: Workflow
metadata:
  name: extension-team-kickoff
  version: 1.0.0
  description: Kicks off extension development team for all critical platforms
  labels:
    priority: critical
    team: extension-development

spec:
  triggers:
    - type: manual
    - type: schedule
      schedule: "0 0 * * *"  # Daily at midnight

  inputs:
    type: object
    properties:
      platforms:
        type: array
        items:
          type: object
          properties:
            name:
              type: string
            priority:
              type: string
              enum: [critical, high, medium, low]
            deadline:
              type: string
              format: date
        description: List of platforms to build extensions for
      parallel_limit:
        type: integer
        default: 5
        description: Maximum parallel extensions to build

  steps:
    # Parallel execution for all platforms
    - id: build-extensions
      name: Build All Extensions
      kind: Parallel
      parallel:
        # Critical platforms (Q1 2025)
        - id: vertex-ai
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'vertex-ai', priority: 'critical'} }}"
          input:
            platform: vertex-ai
            priority: critical
            deadline: 2026-02-01

        - id: dialogflow
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'dialogflow', priority: 'critical'} }}"
          input:
            platform: dialogflow
            priority: critical
            deadline: 2026-02-01

        - id: autogpt
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'autogpt', priority: 'critical'} }}"
          input:
            platform: autogpt
            priority: critical
            deadline: 2026-02-15

        - id: n8n
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'n8n', priority: 'critical'} }}"
          input:
            platform: n8n
            priority: critical
            deadline: 2026-02-15

        # High priority platforms (Q2 2025)
        - id: dspy
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'dspy', priority: 'high'} }}"
          input:
            platform: dspy
            priority: high
            deadline: 2026-03-01

        - id: babyagi
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'babyagi', priority: 'high'} }}"
          input:
            platform: babyagi
            priority: high
            deadline: 2026-03-01

        - id: zapier
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'zapier', priority: 'high'} }}"
          input:
            platform: zapier
            priority: high
            deadline: 2026-03-15

        - id: salesforce
          kind: Agent
          ref: ./extension-development-team.ossa.yaml
          condition: "${{ workflow.input.platforms contains {name: 'salesforce', priority: 'high'} }}"
          input:
            platform: salesforce-einstein
            priority: high
            deadline: 2026-03-15

  concurrency:
    max_parallel: "${{ workflow.input.parallel_limit }}"

  error_handling:
    on_failure: notify
    notification:
      channels: [slack, email, pagerduty]
      recipients:
        - team-lead@bluefly.io
        - devops@bluefly.io

  observability:
    tracing:
      enabled: true
      sample_rate: 1.0
    metrics:
      enabled: true
      custom_labels:
        initiative: extension-development
        quarter: Q1-2026
    logging:
      level: debug
      structured: true

extensions:
  crewai:
    crew_name: extension-team-kickoff
    process_type: hierarchical
    delegation_enabled: true
    manager_llm:
      provider: anthropic
      model: claude-sonnet-4-20250514
      temperature: 0.3
    memory_config:
      enabled: true
      short_term:
        provider: rag
      long_term:
        provider: rag
        storage:
          type: chroma
          connection: "${CHROMA_DB_URL}"
