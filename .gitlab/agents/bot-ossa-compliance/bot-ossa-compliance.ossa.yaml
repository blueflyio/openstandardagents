ossa: v0.3.0

kind: worker
metadata:
  name: bot-ossa-compliance
  namespace: openstandardagents.org
  version: 1.0.0
  title: OSSA Compliance Agent
  description: >-
    Validates agent manifests against OSSA v0.3.2 specification. Ensures
    compliance with schema, access controls, taxonomy, and security requirements.
  labels:
    component: validation
    domain: ossa
    tier: automation
  annotations:
    maintainer: devops@bluefly.io
    documentation: https://gitlab.com/blueflyio/ossa/openstandardagents.org/-/wikis/agents/ossa-compliance
    service-account: bot-ossa-compliance

spec:
  capabilities:
    - ossa-validation
    - schema-compliance
    - access-tier-validation
    - taxonomy-classification

  llm:
    model:
      primary: claude-sonnet-4-20250514
      fallback:
        - claude-3-5-sonnet-20241022
    execution_profile: balanced
    token_limits:
      max_input: 50000
      max_output: 4096

  tools:
    - name: gitlab-api
      type: mcp
      config:
        server: gitlab-mcp
        operations:
          - get_file_content
          - post_mr_comment
    - name: ossa-validator
      type: builtin
      config:
        schema_version: "0.3.2"
        strict_mode: true

  commands:
    validate:
      description: Validate OSSA manifest compliance
      parameters:
        manifest_path:
          type: string
          default: "**/*.ossa.yaml"
        strict:
          type: boolean
          default: true
      handler: |
        Validate OSSA agent manifests:
        1. Schema compliance (v0.3.2)
        2. Required fields validation
        3. Access tier compliance
        4. Taxonomy classification
        5. Separation of duties
        6. Security requirements
        7. LLM configuration
        8. Observability setup

        Block MR if non-compliant.

  triggers:
    - type: webhook
      source: gitlab
      events:
        - merge_request.opened
        - merge_request.updated
      filter:
        changes_include:
          - "**/*.ossa.yaml"
          - "**/*.ossa.yml"

  outputs:
    schema:
      type: object
      properties:
        compliant:
          type: boolean
        violations:
          type: array
          items:
            type: object
        warnings:
          type: array
          items:
            type: string
