openapi: 3.1.0
components:
  schemas:
    AgentManifest:
      type: object
      required:
        - apiVersion
        - kind
        - metadata
        - spec
      properties:
        apiVersion:
          type: string
          const: ossa/v0.3.3
        kind:
          type: string
          const: AgentManifest
        metadata:
          $ref: '#/components/schemas/Metadata'
        spec:
          $ref: '#/components/schemas/AgentSpec'

    Metadata:
      type: object
      required:
        - name
        - version
      properties:
        name:
          type: string
          pattern: '^[a-z0-9]([-a-z0-9]*[a-z0-9])?$'
        version:
          type: string
          pattern: '^\d+\.\d+\.\d+(-[a-zA-Z0-9]+)?$'
        namespace:
          type: string
        labels:
          type: object
          additionalProperties:
            type: string
        annotations:
          type: object
          additionalProperties:
            type: string

    AgentSpec:
      type: object
      required:
        - type
        - capabilities
      properties:
        type:
          $ref: '#/components/schemas/AgentType'
        description:
          type: string
        capabilities:
          type: array
          items:
            $ref: '#/components/schemas/Capability'
        interfaces:
          type: array
          items:
            $ref: '#/components/schemas/Interface'
        requirements:
          $ref: '#/components/schemas/Requirements'
        configuration:
          type: object
          additionalProperties: true

    AgentType:
      type: string
      enum:
        - orchestrator
        - worker
        - specialist
        - critic
        - monitor
        - gateway
      description: Agent type classification

    AgentStatus:
      type: string
      enum:
        - registered
        - active
        - inactive
        - suspended
        - deprecated
      description: Current operational status of the agent

    Capability:
      type: object
      required:
        - name
        - category
      properties:
        name:
          type: string
        category:
          type: string
          enum:
            - core
            - analysis
            - generation
            - transformation
            - integration
        description:
          type: string
        version:
          type: string
        parameters:
          type: object
          additionalProperties: true

    Interface:
      type: object
      required:
        - type
        - endpoint
      properties:
        type:
          type: string
          enum:
            - rest
            - graphql
            - grpc
            - websocket
            - mcp
        endpoint:
          type: string
          format: uri
        protocol:
          type: string
        authentication:
          type: object
          properties:
            type:
              type: string
            config:
              type: object
              additionalProperties: true

    Requirements:
      type: object
      properties:
        runtime:
          type: string
        resources:
          $ref: '#/components/schemas/ResourceRequirements'
        dependencies:
          type: array
          items:
            type: string
        environment:
          type: object
          additionalProperties:
            type: string

    ResourceRequirements:
      type: object
      properties:
        cpu:
          type: string
          pattern: '^[0-9]+m?$'
        memory:
          type: string
          pattern: '^[0-9]+(Mi|Gi)$'
        storage:
          type: string
          pattern: '^[0-9]+(Mi|Gi)$'
        gpu:
          type: string

    Agent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        manifest:
          $ref: '#/components/schemas/AgentManifest'
        status:
          $ref: '#/components/schemas/AgentStatus'
        registration:
          $ref: '#/components/schemas/AgentRegistration'
        certification:
          $ref: '#/components/schemas/Certification'
        metrics:
          $ref: '#/components/schemas/AgentMetrics'

    AgentRegistration:
      type: object
      properties:
        id:
          type: string
          format: uuid
        agentId:
          type: string
          format: uuid
        registeredAt:
          type: string
          format: date-time
        expiresAt:
          type: string
          format: date-time
        registeredBy:
          type: string
        federationNode:
          type: string

    AgentMetrics:
      type: object
      properties:
        requestCount:
          type: integer
          description: Total number of requests processed
        errorCount:
          type: integer
          description: Total number of errors encountered
        averageResponseTime:
          type: number
          description: Average response time in milliseconds
        uptime:
          type: integer
          description: Uptime in seconds
        lastActive:
          type: string
          format: date-time
          description: Timestamp of last activity
