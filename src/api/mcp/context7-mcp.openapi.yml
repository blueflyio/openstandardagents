openapi: 3.1.0
info:
  title: Context7 MCP Server API
  description: |
    Context7 MCP Server - Advanced context capture and analysis functionality for OSSA v0.1.9.
    Provides intelligent context management, semantic analysis, and contextual insights.
  version: "@bluefly/ossa/v0.1.9"
  contact:
    name: OSSA Framework
    url: https://gitlab.bluefly.io/llm/openapi-ai-agents-standard
  license:
    name: MIT
    url: https://gitlab.bluefly.io/llm/openapi-ai-agents-standard/-/blob/main/LICENSE

servers:
  - url: mcp://context7
    description: Context7 MCP Server

paths:
  /context/capture:
    post:
      summary: Capture and analyze context
      description: Capture context from various sources and perform semantic analysis
      operationId: captureContext
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContextCaptureRequest'
      responses:
        '200':
          description: Context captured and analyzed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContextCaptureResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /context/analyze:
    post:
      summary: Analyze existing context
      description: Perform deep analysis on previously captured context
      operationId: analyzeContext
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContextAnalysisRequest'
      responses:
        '200':
          description: Context analysis completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContextAnalysisResponse'

  /context/search:
    get:
      summary: Search context database
      description: Semantic search across captured contexts
      operationId: searchContext
      parameters:
        - name: query
          in: query
          required: true
          schema:
            type: string
          description: Search query
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
            maximum: 100
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContextSearchResponse'

  /context/{contextId}:
    get:
      summary: Retrieve specific context
      operationId: getContext
      parameters:
        - name: contextId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Context details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContextDetail'
        '404':
          $ref: '#/components/responses/NotFound'

components:
  schemas:
    ContextCaptureRequest:
      type: object
      required:
        - source
        - content
      properties:
        source:
          type: string
          enum: [text, code, documentation, conversation, file]
        content:
          type: string
          description: Content to capture and analyze
        metadata:
          type: object
          additionalProperties: true
        tags:
          type: array
          items:
            type: string

    ContextCaptureResponse:
      type: object
      properties:
        contextId:
          type: string
        summary:
          type: string
        semanticVector:
          type: array
          items:
            type: number
        entities:
          type: array
          items:
            $ref: '#/components/schemas/Entity'
        relationships:
          type: array
          items:
            $ref: '#/components/schemas/Relationship'
        confidence:
          type: number
          minimum: 0
          maximum: 1

    ContextAnalysisRequest:
      type: object
      required:
        - contextId
      properties:
        contextId:
          type: string
        analysisType:
          type: string
          enum: [semantic, structural, dependency, quality]
        parameters:
          type: object
          additionalProperties: true

    ContextAnalysisResponse:
      type: object
      properties:
        analysisId:
          type: string
        insights:
          type: array
          items:
            $ref: '#/components/schemas/Insight'
        recommendations:
          type: array
          items:
            $ref: '#/components/schemas/Recommendation'
        metrics:
          type: object
          additionalProperties: true

    ContextSearchResponse:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/ContextSearchResult'
        total:
          type: integer
        page:
          type: integer

    ContextSearchResult:
      type: object
      properties:
        contextId:
          type: string
        summary:
          type: string
        relevance:
          type: number
        tags:
          type: array
          items:
            type: string

    ContextDetail:
      type: object
      properties:
        contextId:
          type: string
        content:
          type: string
        source:
          type: string
        metadata:
          type: object
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Entity:
      type: object
      properties:
        type:
          type: string
        value:
          type: string
        confidence:
          type: number

    Relationship:
      type: object
      properties:
        source:
          type: string
        target:
          type: string
        type:
          type: string
        strength:
          type: number

    Insight:
      type: object
      properties:
        type:
          type: string
        description:
          type: string
        confidence:
          type: number
        evidence:
          type: array
          items:
            type: string

    Recommendation:
      type: object
      properties:
        action:
          type: string
        description:
          type: string
        priority:
          type: string
          enum: [low, medium, high, critical]
        impact:
          type: string

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string

    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string