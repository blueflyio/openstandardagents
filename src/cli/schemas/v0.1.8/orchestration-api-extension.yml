# OSSA Orchestration API Extension v1.0
# OpenAPI 3.1 extension for multi-agent orchestration endpoints
# Framework-agnostic orchestration API with UADP discovery and governance

openapi: 3.1.0
info:
  title: OSSA Multi-Agent Orchestration API
  description: |
    **OpenAPI AI Agents Standard (OSSA) - Multi-Agent Orchestration Extension**
    
    This API specification extends the core OSSA agent APIs with standardized 
    multi-agent orchestration capabilities. It provides framework-agnostic 
    endpoints for coordinating LangChain, CrewAI, AutoGen, OpenAI, Anthropic, 
    and custom agents in research workflows.
    
    ## Key Features
    - **Universal Agent Discovery (UADP)**: Automatic discovery of agents across frameworks
    - **Orchestration Patterns**: Support for parallel, sequential, hierarchical coordination
    - **Research Workflows**: Standardized research agent output formats
    - **Governance Integration**: Policy enforcement and compliance checking
    - **Framework Bridges**: Native integration with popular AI frameworks
    
    ## Orchestration Patterns Supported
    - **Parallel**: Execute multiple agents simultaneously
    - **Sequential**: Chain agents in a specific order
    - **Hierarchical**: Multi-level coordination with escalation
    - **Pipeline**: Stream processing through multiple agents
    - **Fanout**: Distribute tasks to multiple specialized agents
    - **MapReduce**: Parallel processing with result aggregation
    - **Circuit Breaker**: Fault tolerance with fallback agents
    
    ## Framework Compatibility
    This API is designed to work seamlessly with:
    - LangChain (chains, tools, agents)
    - CrewAI (crews, roles, tasks)
    - AutoGen (group chat, sequential chat)
    - OpenAI Assistants (function calling, file search)
    - Anthropic Claude (tool use, message threading)
    - MCP Servers (Model Context Protocol)
    - Custom implementations following OSSA standards
  version: "1.0.0"
  contact:
    name: OSSA Development Team
    email: developers@openapi-ai-agents.org
    url: https://openapi-ai-agents.org
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html

# OSSA Extension - Multi-Agent Orchestration
x-openapi-ai-agents-standard:
  version: "1.0.0"
  orchestration:
    supported_patterns: ["parallel", "sequential", "hierarchical", "pipeline", "fanout", "mapreduce", "circuit_breaker"]
    max_agents_per_orchestration: 100
    frameworks_supported: ["langchain", "crewai", "autogen", "openai", "anthropic", "mcp", "custom"]
    governance_integration: true
    uadp_discovery: true
  compliance_frameworks:
    - "ISO_42001_2023"
    - "NIST_AI_RMF_1_0"
    - "EU_AI_Act"
    - "SOX"
    - "HIPAA"
    - "GDPR"

servers:
  - url: https://api.openapi-ai-agents.org/v1
    description: Production OSSA Orchestration Server
  - url: https://staging.openapi-ai-agents.org/v1
    description: Staging OSSA Orchestration Server
  - url: http://localhost:8080/v1
    description: Development OSSA Orchestration Server

paths:
  # Multi-Agent Orchestration Endpoints
  /orchestrate:
    post:
      summary: Start Multi-Agent Orchestration
      description: |
        Initiate a multi-agent orchestration workflow with specified coordination pattern.
        
        This endpoint accepts an orchestration specification and coordinates multiple
        agents according to the defined pattern. It supports all major AI frameworks
        and provides real-time progress tracking with governance integration.
        
        ## Supported Orchestration Patterns
        - **parallel**: Execute agents simultaneously with optional result merging
        - **sequential**: Execute agents in specified order with data passing
        - **hierarchical**: Multi-level coordination with supervisor/worker pattern
        - **pipeline**: Stream data through multiple processing stages
        - **fanout**: Distribute single task to multiple specialized agents
        - **mapreduce**: Parallel processing with aggregation phase
        - **circuit_breaker**: Fault-tolerant execution with fallback strategies
      operationId: startOrchestration
      tags:
        - Orchestration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrchestrationRequest'
            examples:
              parallel_research:
                summary: Parallel research orchestration
                value:
                  orchestration_spec:
                    name: "parallel-research-workflow"
                    strategy: "parallel"
                    agents:
                      - id: "research-agent-1"
                        type: "research"
                        framework: "langchain"
                        capabilities: ["web_research", "document_analysis"]
                      - id: "research-agent-2"
                        type: "research" 
                        framework: "crewai"
                        capabilities: ["data_mining", "trend_analysis"]
                  task_specification:
                    name: "market-research-analysis"
                    type: "research"
                    priority: 7
                    requirements:
                      input:
                        schema:
                          type: object
                          properties:
                            topic: {type: string}
                            scope: {type: string}
                            timeframe: {type: string}
                      output:
                        schema:
                          type: object
                          properties:
                            findings: {type: array}
                            summary: {type: string}
                            confidence: {type: number}
                  governance_policy: "research-compliance-policy"
              sequential_pipeline:
                summary: Sequential pipeline orchestration
                value:
                  orchestration_spec:
                    name: "document-processing-pipeline"
                    strategy: "sequential"
                    agents:
                      - id: "extractor"
                        type: "extraction"
                        framework: "openai"
                      - id: "analyzer"
                        type: "analysis"
                        framework: "anthropic"
                      - id: "summarizer"
                        type: "synthesis"
                        framework: "langchain"
                  task_specification:
                    name: "document-analysis-workflow"
                    type: "analysis"
                    priority: 5
      responses:
        '202':
          description: Orchestration started successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrchestrationResponse'
              example:
                orchestration_id: "orch_7f4a8b9c-1234-5678-9abc-def012345678"
                status: "dispatched"
                started_at: "2025-01-27T10:00:00Z"
                estimated_completion: "2025-01-27T10:15:00Z"
                tracking_url: "/flows/orch_7f4a8b9c-1234-5678-9abc-def012345678"
                agents_count: 2
                coordination_pattern: "parallel"
        '400':
          description: Invalid orchestration specification
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Orchestration not permitted by governance policies
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GovernanceViolation'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal orchestration error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Universal Agent Discovery Protocol (UADP)
  /agents/discover:
    get:
      summary: UADP Agent Discovery
      description: |
        Discover available agents across the workspace using the Universal Agent 
        Discovery Protocol (UADP). This endpoint scans for agents across all 
        supported frameworks and returns their capabilities, compatibility, 
        and availability status.
        
        ## Discovery Features
        - **Hierarchical Scanning**: Discovers agents at workspace and project levels
        - **Capability Indexing**: Returns detailed capability matrices
        - **Framework Detection**: Identifies agent frameworks and versions
        - **Health Monitoring**: Provides real-time agent status
        - **Performance Metrics**: Includes response times and success rates
      operationId: discoverAgents
      tags:
        - Discovery
      parameters:
        - name: workspace_path
          in: query
          description: Path to workspace for agent discovery
          schema:
            type: string
        - name: frameworks
          in: query
          description: Filter by specific frameworks
          style: form
          explode: false
          schema:
            type: array
            items:
              type: string
              enum: ["langchain", "crewai", "autogen", "openai", "anthropic", "mcp", "custom"]
        - name: capabilities
          in: query
          description: Filter by required capabilities
          style: form
          explode: false
          schema:
            type: array
            items:
              type: string
        - name: include_health
          in: query
          description: Include agent health status in response
          schema:
            type: boolean
            default: true
        - name: include_performance
          in: query
          description: Include performance metrics in response
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Agent discovery completed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentDiscoveryResponse'
              example:
                discovery_id: "disc_8e5a9f2d-5678-9abc-def0-123456789abc"
                timestamp: "2025-01-27T10:00:00Z"
                agents_found: 5
                workspace_path: "/Users/example/workspace"
                agents:
                  - id: "research-expert-langchain"
                    name: "Research Expert (LangChain)"
                    type: "research"
                    framework: "langchain"
                    version: "1.2.3"
                    capabilities: ["web_research", "document_analysis", "data_mining"]
                    health_status: "healthy"
                    availability: true
                    performance_metrics:
                      avg_response_time_ms: 250
                      success_rate: 0.98
                      last_used: "2025-01-27T09:45:00Z"
                  - id: "synthesis-agent-crewai"
                    name: "Synthesis Agent (CrewAI)"
                    type: "synthesis"
                    framework: "crewai"
                    capabilities: ["content_synthesis", "report_generation"]
                    health_status: "healthy"
                    availability: true
        '400':
          description: Invalid discovery parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Discovery service error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Orchestration Flow Management
  /flows/{flow_id}:
    get:
      summary: Get Orchestration Flow Status
      description: |
        Retrieve the current status and progress of an orchestration flow.
        Provides real-time information about agent execution, intermediate
        results, and overall progress.
      operationId: getOrchestrationFlow
      tags:
        - Flow Management
      parameters:
        - name: flow_id
          in: path
          required: true
          description: Unique orchestration flow identifier
          schema:
            type: string
            format: uuid
        - name: include_intermediate_results
          in: query
          description: Include intermediate agent results
          schema:
            type: boolean
            default: false
        - name: include_performance_metrics
          in: query
          description: Include detailed performance metrics
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Flow status retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowStatus'
        '404':
          description: Orchestration flow not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Flow status retrieval error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    patch:
      summary: Update Orchestration Flow
      description: |
        Update an active orchestration flow. Supports operations like
        pause, resume, cancel, and dynamic agent addition/removal.
      operationId: updateOrchestrationFlow
      tags:
        - Flow Management
      parameters:
        - name: flow_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FlowUpdateRequest'
      responses:
        '200':
          description: Flow updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowStatus'
        '400':
          description: Invalid flow update request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Orchestration flow not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Flow update conflict (e.g., trying to modify completed flow)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Governance and Audit Trail
  /governance/audit/{audit_id}:
    get:
      summary: Get Audit Trail
      description: |
        Retrieve comprehensive audit trail information for orchestration
        activities. Includes policy evaluations, compliance checks, and
        detailed execution logs.
      operationId: getAuditTrail
      tags:
        - Governance
      parameters:
        - name: audit_id
          in: path
          required: true
          description: Unique audit trail identifier
          schema:
            type: string
        - name: include_policy_evaluations
          in: query
          description: Include detailed policy evaluation results
          schema:
            type: boolean
            default: true
        - name: include_compliance_checks
          in: query
          description: Include compliance framework check results
          schema:
            type: boolean
            default: true
        - name: format
          in: query
          description: Response format for audit data
          schema:
            type: string
            enum: ["json", "pdf", "csv"]
            default: "json"
      responses:
        '200':
          description: Audit trail retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuditTrail'
        '403':
          description: Insufficient permissions to access audit trail
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Audit trail not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /governance/policies:
    get:
      summary: List Governance Policies
      description: |
        Retrieve available governance policies and their current status.
        Useful for understanding which policies apply to orchestrations.
      operationId: listGovernancePolicies
      tags:
        - Governance
      parameters:
        - name: framework
          in: query
          description: Filter policies by compliance framework
          schema:
            type: string
            enum: ["ISO_42001_2023", "NIST_AI_RMF_1_0", "EU_AI_Act", "SOX", "HIPAA", "GDPR"]
        - name: active_only
          in: query
          description: Return only active policies
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: Governance policies retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  policies:
                    type: array
                    items:
                      $ref: '#/components/schemas/GovernancePolicy'
                  total_count:
                    type: integer
                  active_count:
                    type: integer

  # Research Output Management
  /research/outputs:
    post:
      summary: Submit Research Output
      description: |
        Submit standardized research agent output following OSSA format.
        This endpoint validates and stores research results with full
        provenance tracking and quality assessment.
      operationId: submitResearchOutput
      tags:
        - Research
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResearchOutput'
      responses:
        '201':
          description: Research output submitted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  output_id:
                    type: string
                    format: uuid
                  status:
                    type: string
                    enum: ["accepted", "under_review", "validated"]
                  quality_score:
                    type: number
                    minimum: 0
                    maximum: 1
        '400':
          description: Invalid research output format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

    get:
      summary: List Research Outputs
      description: |
        Retrieve research outputs with filtering and pagination support.
        Supports querying by agent, timeframe, quality scores, and tags.
      operationId: listResearchOutputs
      tags:
        - Research
      parameters:
        - name: agent_id
          in: query
          description: Filter by specific agent ID
          schema:
            type: string
        - name: tags
          in: query
          description: Filter by research tags
          style: form
          explode: false
          schema:
            type: array
            items:
              type: string
        - name: min_confidence
          in: query
          description: Minimum confidence score filter
          schema:
            type: number
            minimum: 0
            maximum: 1
        - name: limit
          in: query
          description: Maximum number of results
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: Pagination offset
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Research outputs retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  outputs:
                    type: array
                    items:
                      $ref: '#/components/schemas/ResearchOutput'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'

  # Task Contract Management
  /contracts:
    post:
      summary: Create Task Contract
      description: |
        Create a new task contract following OSSA standards. Task contracts
        define the requirements, success criteria, and execution parameters
        for multi-agent workflows.
      operationId: createTaskContract
      tags:
        - Contracts
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TaskContract'
      responses:
        '201':
          description: Task contract created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  contract_id:
                    type: string
                    format: uuid
                  status:
                    type: string
                    enum: ["draft", "active", "expired"]
                  validation_results:
                    type: array
                    items:
                      $ref: '#/components/schemas/ValidationResult'

    get:
      summary: List Task Contracts
      description: List available task contracts with filtering options
      operationId: listTaskContracts
      tags:
        - Contracts
      parameters:
        - name: status
          in: query
          description: Filter by contract status
          schema:
            type: string
            enum: ["draft", "active", "expired", "all"]
            default: "active"
        - name: task_type
          in: query
          description: Filter by task type
          schema:
            type: string
            enum: ["research", "analysis", "generation", "validation", "synthesis"]
      responses:
        '200':
          description: Task contracts retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  contracts:
                    type: array
                    items:
                      $ref: '#/components/schemas/TaskContract'
                  total_count:
                    type: integer

  # Health and Monitoring
  /health:
    get:
      summary: Orchestration Service Health Check
      description: |
        Check the health status of the orchestration service and all
        connected components including agent registries, governance
        engines, and framework bridges.
      operationId: getOrchestrationHealth
      tags:
        - Health
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrchestrationHealth'
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrchestrationHealth'

components:
  schemas:
    OrchestrationRequest:
      type: object
      required:
        - orchestration_spec
        - task_specification
      properties:
        orchestration_spec:
          type: object
          required:
            - name
            - strategy
            - agents
          properties:
            name:
              type: string
              description: "Orchestration workflow name"
            strategy:
              type: string
              enum: ["parallel", "sequential", "hierarchical", "pipeline", "fanout", "mapreduce", "circuit_breaker"]
            agents:
              type: array
              minItems: 2
              items:
                type: object
                properties:
                  id: {type: string}
                  type: {type: string}
                  role: {type: string}
                  framework: {type: string}
                  capabilities: {type: array, items: {type: string}}
                  priority: {type: integer, minimum: 1, maximum: 10}
            coordination:
              type: object
              properties:
                timeout_seconds: {type: integer}
                retry_policy: {type: object}
                conflict_resolution: {type: string}
        task_specification:
          $ref: '#/components/schemas/TaskContract'
        governance_policy:
          type: string
          description: "Governance policy to apply"
        priority:
          type: integer
          minimum: 1
          maximum: 10
          default: 5
        metadata:
          type: object
          additionalProperties: true
          description: "Additional orchestration metadata"

    OrchestrationResponse:
      type: object
      required:
        - orchestration_id
        - status
        - started_at
      properties:
        orchestration_id:
          type: string
          format: uuid
          description: "Unique orchestration identifier"
        status:
          type: string
          enum: ["planned", "dispatched", "running", "completed", "failed", "cancelled"]
        started_at:
          type: string
          format: date-time
        estimated_completion:
          type: string
          format: date-time
        tracking_url:
          type: string
          format: uri
        agents_count:
          type: integer
        coordination_pattern:
          type: string
        governance_applied:
          type: boolean
        compliance_status:
          type: string
          enum: ["compliant", "non_compliant", "under_review"]

    AgentDiscoveryResponse:
      type: object
      required:
        - discovery_id
        - timestamp
        - agents_found
        - agents
      properties:
        discovery_id:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        agents_found:
          type: integer
        workspace_path:
          type: string
        agents:
          type: array
          items:
            type: object
            properties:
              id: {type: string}
              name: {type: string}
              type: {type: string}
              framework: {type: string}
              version: {type: string}
              capabilities: {type: array, items: {type: string}}
              health_status: {type: string, enum: ["healthy", "degraded", "unhealthy"]}
              availability: {type: boolean}
              performance_metrics:
                type: object
                properties:
                  avg_response_time_ms: {type: integer}
                  success_rate: {type: number}
                  last_used: {type: string, format: date-time}

    FlowStatus:
      type: object
      required:
        - flow_id
        - status
        - created_at
        - agents
      properties:
        flow_id:
          type: string
          format: uuid
        status:
          type: string
          enum: ["planned", "dispatched", "running", "completed", "failed", "cancelled", "paused"]
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
        agents:
          type: array
          items:
            type: object
            properties:
              agent_id: {type: string}
              status: {type: string}
              started_at: {type: string, format: date-time}
              completed_at: {type: string, format: date-time}
              result: {type: object}
        progress:
          type: object
          properties:
            percentage: {type: number, minimum: 0, maximum: 100}
            completed_agents: {type: integer}
            total_agents: {type: integer}
            current_stage: {type: string}
        performance_metrics:
          type: object
          properties:
            total_duration_ms: {type: integer}
            agent_durations_ms: {type: array, items: {type: integer}}
            tokens_used: {type: integer}
            cost_incurred: {type: number}

    FlowUpdateRequest:
      type: object
      required:
        - action
      properties:
        action:
          type: string
          enum: ["pause", "resume", "cancel", "add_agent", "remove_agent", "update_priority"]
        agent_id:
          type: string
          description: "Required for agent-specific actions"
        priority:
          type: integer
          minimum: 1
          maximum: 10
          description: "Required for priority updates"
        reason:
          type: string
          description: "Optional reason for the update"

    TaskContract:
      type: object
      description: "Reference to the complete task contract schema"
      # This would reference the full task-contract.yml schema

    ResearchOutput:
      type: object
      description: "Reference to the complete research output schema"
      # This would reference the full research-output.yml schema

    AuditTrail:
      type: object
      required:
        - audit_id
        - orchestration_id
        - timestamp
        - events
      properties:
        audit_id:
          type: string
        orchestration_id:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        events:
          type: array
          items:
            type: object
            properties:
              event_type: {type: string}
              timestamp: {type: string, format: date-time}
              agent_id: {type: string}
              description: {type: string}
              data: {type: object}
        policy_evaluations:
          type: array
          items:
            type: object
            properties:
              policy_id: {type: string}
              result: {type: string, enum: ["pass", "fail", "warning"]}
              details: {type: string}
        compliance_checks:
          type: array
          items:
            type: object
            properties:
              framework: {type: string}
              status: {type: string}
              controls_evaluated: {type: array, items: {type: string}}

    GovernancePolicy:
      type: object
      required:
        - policy_id
        - name
        - framework
        - status
      properties:
        policy_id:
          type: string
        name:
          type: string
        description:
          type: string
        framework:
          type: string
        status:
          type: string
          enum: ["active", "inactive", "draft"]
        version:
          type: string
        created_at:
          type: string
          format: date-time
        controls:
          type: array
          items:
            type: string

    OrchestrationHealth:
      type: object
      required:
        - status
        - timestamp
        - components
      properties:
        status:
          type: string
          enum: ["healthy", "degraded", "unhealthy"]
        timestamp:
          type: string
          format: date-time
        version:
          type: string
        uptime_seconds:
          type: integer
        components:
          type: object
          properties:
            agent_discovery:
              $ref: '#/components/schemas/ComponentHealth'
            governance_engine:
              $ref: '#/components/schemas/ComponentHealth'
            orchestration_engine:
              $ref: '#/components/schemas/ComponentHealth'
            framework_bridges:
              type: object
              properties:
                langchain: {$ref: '#/components/schemas/ComponentHealth'}
                crewai: {$ref: '#/components/schemas/ComponentHealth'}
                autogen: {$ref: '#/components/schemas/ComponentHealth'}
                openai: {$ref: '#/components/schemas/ComponentHealth'}
                anthropic: {$ref: '#/components/schemas/ComponentHealth'}

    ComponentHealth:
      type: object
      required:
        - status
        - response_time_ms
      properties:
        status:
          type: string
          enum: ["healthy", "degraded", "unhealthy"]
        response_time_ms:
          type: integer
        last_check:
          type: string
          format: date-time
        error_rate:
          type: number
          minimum: 0
          maximum: 1

    PaginationInfo:
      type: object
      properties:
        total: {type: integer}
        limit: {type: integer}
        offset: {type: integer}
        has_more: {type: boolean}

    ValidationResult:
      type: object
      properties:
        field: {type: string}
        message: {type: string}
        severity: {type: string, enum: ["error", "warning", "info"]}

    ValidationError:
      type: object
      properties:
        error:
          type: object
          properties:
            code: {type: string}
            message: {type: string}
            validation_errors:
              type: array
              items:
                $ref: '#/components/schemas/ValidationResult'

    GovernanceViolation:
      type: object
      properties:
        error:
          type: object
          properties:
            code: {type: string, example: "GOVERNANCE_VIOLATION"}
            message: {type: string}
            policy_violations:
              type: array
              items:
                type: object
                properties:
                  policy_id: {type: string}
                  violation_type: {type: string}
                  description: {type: string}
                  severity: {type: string}

    Error:
      type: object
      required:
        - error
      properties:
        error:
          type: object
          required:
            - code
            - message
            - timestamp
          properties:
            code:
              type: string
              description: "Error code identifier"
            message:
              type: string
              description: "Human-readable error message"
            details:
              type: object
              description: "Additional error details"
            timestamp:
              type: string
              format: date-time
            request_id:
              type: string
              format: uuid

  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: "API key for authentication"
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "JWT token for authentication"
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: /oauth/authorize
          tokenUrl: /oauth/token
          scopes:
            orchestrate: "Create and manage orchestrations"
            discover: "Discover agents"
            audit: "Access audit trails"
            governance: "Manage governance policies"

security:
  - ApiKeyAuth: []
  - BearerAuth: []

tags:
  - name: Orchestration
    description: "Multi-agent orchestration operations"
  - name: Discovery
    description: "Universal Agent Discovery Protocol (UADP) operations"
  - name: Flow Management
    description: "Orchestration flow lifecycle management"
  - name: Governance
    description: "Governance and compliance operations"
  - name: Research
    description: "Research output management"
  - name: Contracts
    description: "Task contract management"
  - name: Health
    description: "Service health and monitoring"