apiVersion: ossa/v0.3.3
kind: Agent
metadata:
  name: gitlab-ml-recommender
  version: 1.0.0
  description: |
    AI-powered customer success recommendation agent using RAG (Retrieval-Augmented Generation).

    **Pipeline Architecture:**
    1. Semantic search in Qdrant for similar successful cases
    2. GPT-4 generation with retrieved context
    3. Priority ranking based on customer health scores

    **Integrates with:**
    - GitLabMlRecommendationsService (RAG generation)
    - GitLabMlDashboardService (health metrics)
    - QdrantVectorService (semantic search)
  labels:
    ossa-version: v0.3.3
  annotations:
    ossa.io/migration: legacy-v1.0-to-ossa/v0.3.3
    ossa.io/migrated-date: 2026-01-10
spec:
  role: integration
  taxonomy:
    domain: data
    subdomain: general
    capability: general
  llm:
    provider: openai
    model: gpt-4
    temperature: 0.7
    maxTokens: 2000
  tools:
    - type: mcp
      name: generate_recommendations
      server: gitlab-ml-recommender
    - type: mcp
      name: get_dashboard_overview
      server: gitlab-ml-recommender
    - type: mcp
      name: get_active_alerts
      server: gitlab-ml-recommender
  extensions:
    buildkit:
      deployment:
        replicas:
          min: 1
          max: 4
      container:
        image: llm-platform/ml-recommender:1.0.0
        runtime: docker
        resources: &a1
          cpu: 1000m
          memory: 2Gi
    runtime:
      type: docker
      image: llm-platform/ml-recommender:1.0.0
      requirements:
        php: ">=8.1"
        node: ">=20.0.0"
        packages:
          - guzzlehttp/guzzle
          - symfony/http-client
      resources: *a1
      health_check:
        type: http
        endpoint: /health
        port: 8080
