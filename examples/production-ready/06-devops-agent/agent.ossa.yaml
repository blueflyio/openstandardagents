apiVersion: ossa/v0.3.6
kind: Agent
metadata:
  name: devops-agent
  version: 1.0.0
  description: |
    DevOps agent for infrastructure management and deployment automation.
    Monitors system health, deploys services, and performs rollbacks.
  labels:
    platform: anthropic
    export: anthropic
    use-case: devops
    tier: production
spec:
  role: |
    You are a DevOps engineer specializing in:
    - Infrastructure monitoring and health checks
    - Automated deployment and rollback
    - Incident response and remediation
    - Performance optimization
    - Security compliance

  llm:
    provider: anthropic
    model: claude-sonnet-4-20250514
    temperature: 0.2
    maxTokens: 3000

  capabilities:
    - check_status
    - deploy_service
    - rollback_deployment
    - scale_service
    - analyze_logs

  tools:
    - type: function
      name: check_status
      description: Check system and service health
      parameters:
        type: object
        properties:
          service:
            type: string
          environment:
            type: string
            enum: [dev, staging, production]
          checks:
            type: array
            items:
              type: string
              enum: [health, metrics, logs, resources]

    - type: function
      name: deploy_service
      description: Deploy service to environment
      parameters:
        type: object
        properties:
          service:
            type: string
          version:
            type: string
          environment:
            type: string
          strategy:
            type: string
            enum: [rolling, blue_green, canary]
          validation:
            type: object
        required:
          - service
          - version
          - environment

    - type: function
      name: rollback_deployment
      description: Rollback to previous version
      parameters:
        type: object
        properties:
          service:
            type: string
          environment:
            type: string
          targetVersion:
            type: string
        required:
          - service
          - environment

    - type: function
      name: scale_service
      description: Scale service instances
      parameters:
        type: object
        properties:
          service:
            type: string
          replicas:
            type: integer
          environment:
            type: string

  autonomy:
    level: supervised
    approval_required: true
    approval_conditions:
      - environment == 'production'
      - action == 'rollback'
    auto_approve_conditions:
      - environment == 'dev'

  safety:
    guardrails:
      - type: environment_protection
        protected_environments: [production]
      - type: deployment_window
        allowed_times: "09:00-17:00 UTC"
      - type: change_validation
        require_approval: true

  observability:
    logging:
      level: info
    metrics:
      enabled: true
      metrics:
        - deployments_total
        - rollbacks_total
        - deployment_duration
        - success_rate
    tracing:
      enabled: true

extensions:
  anthropic:
    use_extended_thinking: true
    export_config:
      format: typescript
      output_file: devops-agent.ts
