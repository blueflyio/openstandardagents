apiVersion: ossa/v0.4.1
kind: Agent
metadata:
  name: ci-pipeline
  version: 1.0.0
  description: CI/CD automation agent for pipeline management
  labels:
    ossa.dev/category: devops
    ossa.dev/tier: standard-example
    ossa.dev/runtime: gitlab-ci
  annotations:
    ossa.dev/documentation: https://openstandardagents.org/agents/ci-pipeline
spec:
  capabilities:
  - name: ci.trigger
    description: Trigger CI/CD pipeline runs
  - name: ci.monitor
    description: Monitor pipeline status and jobs
  - name: ci.fix
    description: Analyze and fix pipeline failures
  - name: ci.optimize
    description: Optimize pipeline performance
  role: 'You are a CI/CD automation specialist responsible for managing build, test,

    and deployment pipelines. You can trigger pipelines, monitor their status,

    diagnose failures, and optimize performance.


    Pipeline management:

    1. Trigger appropriate pipelines based on changes

    2. Monitor job status and detect failures early

    3. Analyze failure logs and suggest fixes

    4. Optimize pipeline DAGs for faster execution

    5. Manage deployment approvals and rollbacks

    '
  llm:
    provider: ${OSSA_LLM_PROVIDER:-anthropic}
    model: ${OSSA_LLM_MODEL:-claude-sonnet-4}
    temperature: 0.2
    maxTokens: ${OSSA_LLM_MAX_TOKENS:-8192}
  tools:
  - name: gitlab.pipeline.trigger
    description: Trigger a GitLab CI pipeline
    handler:
      runtime: api
      endpoint: ${GITLAB_API_URL}/projects/${CI_PROJECT_ID}/pipeline
      method: POST
    type: function
  - name: gitlab.pipeline.status
    description: Get pipeline status
    handler:
      runtime: api
      endpoint: ${GITLAB_API_URL}/projects/${CI_PROJECT_ID}/pipelines/${PIPELINE_ID}
      method: GET
    type: function
  - name: gitlab.job.log
    description: Get job logs for analysis
    handler:
      runtime: api
      endpoint: ${GITLAB_API_URL}/projects/${CI_PROJECT_ID}/jobs/${JOB_ID}/trace
      method: GET
    type: function
  - name: gitlab.mr.create
    description: Create merge request with fixes
    handler:
      runtime: api
      endpoint: ${GITLAB_API_URL}/projects/${CI_PROJECT_ID}/merge_requests
      method: POST
    type: function
  messaging:
    transport: redis
    queues:
    - name: ci-events
      description: CI/CD event notifications
    - name: ci-commands
      description: Pipeline commands
    events:
      publish:
      - pipeline.triggered
      - pipeline.completed
      - pipeline.failed
      subscribe:
      - merge_request.created
      - push.received
extensions:
  gitlab:
    project_access_token: ${CI_JOB_TOKEN}
    api_version: v4
    webhooks:
    - event: pipeline_events
      url: ${OSSA_WEBHOOK_URL}/ci-pipeline
    - event: merge_request_events
      url: ${OSSA_WEBHOOK_URL}/ci-pipeline
